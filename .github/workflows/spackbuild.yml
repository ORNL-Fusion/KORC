name: spackbuild
on: [ push, workflow_dispatch ]

jobs:
  job_one:
    runs-on: ubuntu-latest
    steps:
      - name: grab main project
        uses: actions/checkout@v2

      - name: grab spack
        uses: actions/checkout@v2
        with:
          repository: spack/spack
          path: ./spack

      - name: spack setup
        run: |
          ls -la ./spack/share/spack/
          . ./spack/share/spack/setup-env.sh
          which spack
          spack --version
          set -x
          df -h
          pwd -P
          lsblk
          findmnt


      - name: spack install
        run: |
          . ./spack/share/spack/setup-env.sh
          spack find
          spack install gcc@13.1.0

      - name: spack mirror
        run: |
          . ./spack/share/spack/setup-env.sh
          spack mirror list
          spack mirror create -d ./mirror-nacho --all
          spack mirror list


#          spack env activate -d ./spackenv-nacho
