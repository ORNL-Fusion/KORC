<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Kinetic Orbit Runaway electrons Code (KORC)">
    
    <meta name="author" content="Matt Beidler" >
    <link rel="icon" href="../favicon.png">

    <title>adv_FOm3dc1_top &ndash; KORC</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">KORC </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>README</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>adv_FOm3dc1_top
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.7% of total for procedures.">137 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/korc_ppusher.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/korc_ppusher.f90.html'>korc_ppusher.f90</a></li>
    
     <li><a href='../module/korc_ppusher.html'>korc_ppusher</a></li>
    
  
     <li class="active">adv_FOm3dc1_top</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/adv_fom3dc1_top.html#src">adv_FOm3dc1_top</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine adv_FOm3dc1_top(params, F, P, spp)
    
    
   
</h2>
    
  


    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-params~63"></span>type(KORC_PARAMS),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>params</strong></td><td><p>Core KORC simulation parameters.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f~19"></span>type(FIELDS),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>F</strong></td><td><p>An instance of the KORC derived type FIELDS.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-p~20"></span>type(PROFILES),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>P</strong></td><td><p>An instance of the KORC derived type PROFILES.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-spp~25"></span>type(SPECIES),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>spp</strong></td><td><p>An instance of the derived type SPECIES containing all the parameters
 and simulation variables of the different species in the simulation.</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~adv_fom3dc1_top~~CallsGraph Pages: 1 -->
<svg id="procadv_fom3dc1_topCallsGraph" width="641pt" height="443pt"
 viewBox="0.00 0.00 641.00 443.13" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~adv_fom3dc1_top~~CallsGraph" class="graph" transform="scale(.6134 .6134) rotate(0) translate(4 718.418)">
<title>proc~~adv_fom3dc1_top~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-718.418 1041,-718.418 1041,4 -4,4"/>
<!-- proc~adv_fom3dc1_top -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node1" class="node">
<title>proc~adv_fom3dc1_top</title>
<polygon fill="none" stroke="#000000" points="102,-384.418 0,-384.418 0,-360.418 102,-360.418 102,-384.418"/>
<text text-anchor="middle" x="51" y="-370.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">adv_FOm3dc1_top</text>
</g>
<!-- cart_to_cyl_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node2" class="node">
<title>cart_to_cyl_p</title>
<polygon fill="#777777" stroke="#777777" points="647.5,-633.418 572.5,-633.418 572.5,-609.418 647.5,-609.418 647.5,-633.418"/>
<text text-anchor="middle" x="610" y="-619.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cart_to_cyl_p</text>
</g>
<!-- proc~adv_fom3dc1_top&#45;&gt;cart_to_cyl_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge1" class="edge">
<title>proc~adv_fom3dc1_top&#45;&gt;cart_to_cyl_p</title>
<path fill="none" stroke="#000000" d="M60.695,-384.6909C75.5506,-402.749 105.6439,-436.4877 138,-456.418 279.6585,-543.6748 473.7683,-592.7626 562.3892,-611.925"/>
<polygon fill="#000000" stroke="#000000" points="561.8998,-615.3992 572.4098,-614.0609 563.3591,-608.553 561.8998,-615.3992"/>
</g>
<!-- proc~get_m3d_c1_vector_potential_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node3" class="node">
<title>proc~get_m3d_c1_vector_potential_p</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node3"><a xlink:href=".././proc/get_m3d_c1_vector_potential_p.html" xlink:title="get_m3d_c1_vector_potential_p">
<polygon fill="#d9534f" stroke="#d9534f" points="306.5,-363.418 144.5,-363.418 144.5,-339.418 306.5,-339.418 306.5,-363.418"/>
<text text-anchor="middle" x="225.5" y="-349.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">get_m3d_c1_vector_potential_p</text>
</a>
</g>
</g>
<!-- proc~adv_fom3dc1_top&#45;&gt;proc~get_m3d_c1_vector_potential_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge6" class="edge">
<title>proc~adv_fom3dc1_top&#45;&gt;proc~get_m3d_c1_vector_potential_p</title>
<path fill="none" stroke="#000000" d="M102.4119,-366.2308C112.4951,-365.0174 123.3513,-363.7109 134.2905,-362.3945"/>
<polygon fill="#000000" stroke="#000000" points="134.8303,-365.8548 144.3404,-361.185 133.9938,-358.905 134.8303,-365.8548"/>
</g>
<!-- proc~get_m3d_c1_foelectric_fields_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node4" class="node">
<title>proc~get_m3d_c1_foelectric_fields_p</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node4"><a xlink:href=".././proc/get_m3d_c1_foelectric_fields_p.html" xlink:title="get_m3d_c1_FOelectric_fields_p">
<polygon fill="#d9534f" stroke="#d9534f" points="308.5,-321.418 142.5,-321.418 142.5,-297.418 308.5,-297.418 308.5,-321.418"/>
<text text-anchor="middle" x="225.5" y="-307.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">get_m3d_c1_FOelectric_fields_p</text>
</a>
</g>
</g>
<!-- proc~adv_fom3dc1_top&#45;&gt;proc~get_m3d_c1_foelectric_fields_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge2" class="edge">
<title>proc~adv_fom3dc1_top&#45;&gt;proc~get_m3d_c1_foelectric_fields_p</title>
<path fill="none" stroke="#000000" d="M72.6098,-360.3756C89.8823,-351.1492 114.9362,-338.6454 138,-330.418 144.3271,-328.1609 150.9974,-326.0696 157.717,-324.1521"/>
<polygon fill="#000000" stroke="#000000" points="158.8358,-327.4749 167.5632,-321.4679 156.9947,-320.7213 158.8358,-327.4749"/>
</g>
<!-- proc~get_m3d_c1_fomagnetic_fields_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node5" class="node">
<title>proc~get_m3d_c1_fomagnetic_fields_p</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node5"><a xlink:href=".././proc/get_m3d_c1_fomagnetic_fields_p.html" xlink:title="get_m3d_c1_FOmagnetic_fields_p">
<polygon fill="#d9534f" stroke="#d9534f" points="313,-279.418 138,-279.418 138,-255.418 313,-255.418 313,-279.418"/>
<text text-anchor="middle" x="225.5" y="-265.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">get_m3d_c1_FOmagnetic_fields_p</text>
</a>
</g>
</g>
<!-- proc~adv_fom3dc1_top&#45;&gt;proc~get_m3d_c1_fomagnetic_fields_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge4" class="edge">
<title>proc~adv_fom3dc1_top&#45;&gt;proc~get_m3d_c1_fomagnetic_fields_p</title>
<path fill="none" stroke="#000000" d="M59.9708,-360.3297C74.3308,-341.8801 104.3132,-306.8956 138,-288.418 141.5206,-286.4869 145.2163,-284.7319 149.0165,-283.137"/>
<polygon fill="#000000" stroke="#000000" points="150.5251,-286.3083 158.6375,-279.4936 148.0461,-279.762 150.5251,-286.3083"/>
</g>
<!-- proc~advance_fom3dc1_vars -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node6" class="node">
<title>proc~advance_fom3dc1_vars</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node6"><a xlink:href=".././proc/advance_fom3dc1_vars.html" xlink:title="advance_FOm3dc1_vars">
<polygon fill="#d9534f" stroke="#d9534f" points="290.5,-405.418 160.5,-405.418 160.5,-381.418 290.5,-381.418 290.5,-405.418"/>
<text text-anchor="middle" x="225.5" y="-391.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advance_FOm3dc1_vars</text>
</a>
</g>
</g>
<!-- proc~adv_fom3dc1_top&#45;&gt;proc~advance_fom3dc1_vars -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge5" class="edge">
<title>proc~adv_fom3dc1_top&#45;&gt;proc~advance_fom3dc1_vars</title>
<path fill="none" stroke="#000000" d="M102.4119,-378.6051C117.481,-380.4185 134.2763,-382.4397 150.4956,-384.3916"/>
<polygon fill="#000000" stroke="#000000" points="150.1528,-387.8756 160.4994,-385.5955 150.9892,-380.9257 150.1528,-387.8756"/>
</g>
<!-- proc~advance_fp3dinterp_vars -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node7" class="node">
<title>proc~advance_fp3dinterp_vars</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node7"><a xlink:href=".././proc/advance_fp3dinterp_vars.html" xlink:title="advance_FP3Dinterp_vars">
<polygon fill="#d9534f" stroke="#d9534f" points="294,-447.418 157,-447.418 157,-423.418 294,-423.418 294,-447.418"/>
<text text-anchor="middle" x="225.5" y="-433.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advance_FP3Dinterp_vars</text>
</a>
</g>
</g>
<!-- proc~adv_fom3dc1_top&#45;&gt;proc~advance_fp3dinterp_vars -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge3" class="edge">
<title>proc~adv_fom3dc1_top&#45;&gt;proc~advance_fp3dinterp_vars</title>
<path fill="none" stroke="#000000" d="M72.6098,-384.4604C89.8823,-393.6868 114.9362,-406.1906 138,-414.418 144.3271,-416.675 150.9974,-418.7663 157.717,-420.6838"/>
<polygon fill="#000000" stroke="#000000" points="156.9947,-424.1146 167.5632,-423.368 158.8358,-417.361 156.9947,-424.1146"/>
</g>
<!-- interface~fio_eval_field -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node8" class="node">
<title>interface~fio_eval_field</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node8"><a xlink:href=".././interface/fio_eval_field.html" xlink:title="fio_eval_field">
<polygon fill="#a7506f" stroke="#a7506f" points="471.5,-321.418 397.5,-321.418 397.5,-297.418 471.5,-297.418 471.5,-321.418"/>
<text text-anchor="middle" x="434.5" y="-307.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fio_eval_field</text>
</a>
</g>
</g>
<!-- proc~get_m3d_c1_vector_potential_p&#45;&gt;interface~fio_eval_field -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge7" class="edge">
<title>proc~get_m3d_c1_vector_potential_p&#45;&gt;interface~fio_eval_field</title>
<path fill="none" stroke="#000000" d="M285.391,-339.3824C317.7944,-332.8708 357.2424,-324.9434 387.4228,-318.8785"/>
<polygon fill="#000000" stroke="#000000" points="388.1646,-322.2994 397.279,-316.8978 386.7854,-315.4366 388.1646,-322.2994"/>
</g>
<!-- proc~get_m3d_c1_foelectric_fields_p&#45;&gt;interface~fio_eval_field -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge8" class="edge">
<title>proc~get_m3d_c1_foelectric_fields_p&#45;&gt;interface~fio_eval_field</title>
<path fill="none" stroke="#000000" d="M308.7029,-309.418C335.3562,-309.418 363.9399,-309.418 387.1144,-309.418"/>
<polygon fill="#000000" stroke="#000000" points="387.3552,-312.9181 397.3551,-309.418 387.3551,-305.9181 387.3552,-312.9181"/>
</g>
<!-- proc~get_m3d_c1_fomagnetic_fields_p&#45;&gt;interface~fio_eval_field -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge9" class="edge">
<title>proc~get_m3d_c1_fomagnetic_fields_p&#45;&gt;interface~fio_eval_field</title>
<path fill="none" stroke="#000000" d="M285.391,-279.4535C317.7944,-285.9652 357.2424,-293.8925 387.4228,-299.9575"/>
<polygon fill="#000000" stroke="#000000" points="386.7854,-303.3993 397.279,-301.9381 388.1646,-296.5365 386.7854,-303.3993"/>
</g>
<!-- proc~radiation_force_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node9" class="node">
<title>proc~radiation_force_p</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node9"><a xlink:href=".././proc/radiation_force_p.html" xlink:title="radiation_force_p">
<polygon fill="#d9534f" stroke="#d9534f" points="481.5,-384.418 387.5,-384.418 387.5,-360.418 481.5,-360.418 481.5,-384.418"/>
<text text-anchor="middle" x="434.5" y="-370.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">radiation_force_p</text>
</a>
</g>
</g>
<!-- proc~advance_fom3dc1_vars&#45;&gt;proc~radiation_force_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge10" class="edge">
<title>proc~advance_fom3dc1_vars&#45;&gt;proc~radiation_force_p</title>
<path fill="none" stroke="#000000" d="M290.7692,-386.8598C318.4883,-384.0746 350.5156,-380.8566 377.2926,-378.1661"/>
<polygon fill="#000000" stroke="#000000" points="377.6782,-381.645 387.2781,-377.1627 376.9783,-374.6801 377.6782,-381.645"/>
</g>
<!-- proc~include_coulombcollisions_fo_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node10" class="node">
<title>proc~include_coulombcollisions_fo_p</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node10"><a xlink:href=".././proc/include_coulombcollisions_fo_p.html" xlink:title="include_CoulombCollisions_FO_p">
<polygon fill="#d9534f" stroke="#d9534f" points="520,-426.418 349,-426.418 349,-402.418 520,-402.418 520,-426.418"/>
<text text-anchor="middle" x="434.5" y="-412.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">include_CoulombCollisions_FO_p</text>
</a>
</g>
</g>
<!-- proc~advance_fom3dc1_vars&#45;&gt;proc~include_coulombcollisions_fo_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge11" class="edge">
<title>proc~advance_fom3dc1_vars&#45;&gt;proc~include_coulombcollisions_fo_p</title>
<path fill="none" stroke="#000000" d="M290.7692,-399.9761C305.9446,-401.5009 322.4113,-403.1555 338.6007,-404.7822"/>
<polygon fill="#000000" stroke="#000000" points="338.3313,-408.2726 348.6311,-405.79 339.0312,-401.3077 338.3313,-408.2726"/>
</g>
<!-- proc~advance_fp3dinterp_vars&#45;&gt;proc~include_coulombcollisions_fo_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge12" class="edge">
<title>proc~advance_fp3dinterp_vars&#45;&gt;proc~include_coulombcollisions_fo_p</title>
<path fill="none" stroke="#000000" d="M294.2239,-428.5127C308.434,-427.0849 323.6479,-425.5562 338.624,-424.0514"/>
<polygon fill="#000000" stroke="#000000" points="339.3388,-427.4973 348.9387,-423.015 338.6389,-420.5324 339.3388,-427.4973"/>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;cart_to_cyl_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge17" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;cart_to_cyl_p</title>
<path fill="none" stroke="#000000" d="M470.69,-426.531C487.9584,-434.0401 507.5247,-445.3703 520,-461.418 559.1671,-511.8008 513.6018,-552.7222 556,-600.418 558.2388,-602.9365 560.8164,-605.1555 563.6057,-607.1102"/>
<polygon fill="#000000" stroke="#000000" points="562.0687,-610.2638 572.482,-612.2168 565.5595,-604.1963 562.0687,-610.2638"/>
</g>
<!-- proc~dca_sd -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node11" class="node">
<title>proc~dca_sd</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node11"><a xlink:href=".././proc/dca_sd.html" xlink:title="dCA_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="637,-232.418 583,-232.418 583,-208.418 637,-208.418 637,-232.418"/>
<text text-anchor="middle" x="610" y="-218.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dCA_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~dca_sd -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge13" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~dca_sd</title>
<path fill="none" stroke="#000000" d="M507.8976,-402.4058C512.2987,-399.9132 516.395,-396.9459 520,-393.418 564.0741,-350.2863 520.9825,-310.1786 556,-259.418 561.7023,-251.152 569.7493,-244.0064 577.8942,-238.1722"/>
<polygon fill="#000000" stroke="#000000" points="579.9288,-241.0226 586.3234,-232.5751 576.0566,-235.1912 579.9288,-241.0226"/>
</g>
<!-- proc~cf_sd -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node12" class="node">
<title>proc~cf_sd</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node12"><a xlink:href=".././proc/cf_sd.html" xlink:title="CF_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="637,-292.418 583,-292.418 583,-268.418 637,-268.418 637,-292.418"/>
<text text-anchor="middle" x="610" y="-278.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CF_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~cf_sd -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge14" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~cf_sd</title>
<path fill="none" stroke="#000000" d="M502.0782,-402.357C508.377,-399.9081 514.4649,-396.9621 520,-393.418 556.3335,-370.1533 584.4757,-327.1309 599.0292,-301.4087"/>
<polygon fill="#000000" stroke="#000000" points="602.1891,-302.9255 603.9304,-292.4748 596.052,-299.5587 602.1891,-302.9255"/>
</g>
<!-- proc~cb_ei_sd -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node13" class="node">
<title>proc~cb_ei_sd</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node13"><a xlink:href=".././proc/cb_ei_sd.html" xlink:title="CB_ei_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="641,-426.418 579,-426.418 579,-402.418 641,-402.418 641,-426.418"/>
<text text-anchor="middle" x="610" y="-412.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CB_ei_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~cb_ei_sd -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge15" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~cb_ei_sd</title>
<path fill="none" stroke="#000000" d="M520.1935,-414.418C537.1376,-414.418 554.1839,-414.418 568.8036,-414.418"/>
<polygon fill="#000000" stroke="#000000" points="568.984,-417.9181 578.984,-414.418 568.984,-410.9181 568.984,-417.9181"/>
</g>
<!-- proc~unitvectors_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node14" class="node">
<title>proc~unitvectors_p</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node14"><a xlink:href=".././proc/unitvectors_p.html" xlink:title="unitVectors_p">
<polygon fill="#d9534f" stroke="#d9534f" points="648.5,-106.418 571.5,-106.418 571.5,-82.418 648.5,-82.418 648.5,-106.418"/>
<text text-anchor="middle" x="610" y="-92.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">unitVectors_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~unitvectors_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge16" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~unitvectors_p</title>
<path fill="none" stroke="#000000" d="M509.6081,-402.2092C513.4305,-399.7429 516.9443,-396.8369 520,-393.418 603.0244,-300.526 479.1868,-213.5083 556,-115.418 557.8896,-113.0049 560.0943,-110.8688 562.5124,-108.9779"/>
<polygon fill="#000000" stroke="#000000" points="564.7635,-111.6997 571.4079,-103.4473 561.0674,-105.755 564.7635,-111.6997"/>
</g>
<!-- proc~cb_ee_sd -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node15" class="node">
<title>proc~cb_ee_sd</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node15"><a xlink:href=".././proc/cb_ee_sd.html" xlink:title="CB_ee_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="642.5,-148.418 577.5,-148.418 577.5,-124.418 642.5,-124.418 642.5,-148.418"/>
<text text-anchor="middle" x="610" y="-134.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CB_ee_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~cb_ee_sd -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge18" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~cb_ee_sd</title>
<path fill="none" stroke="#000000" d="M509.1329,-402.3712C513.126,-399.8729 516.8027,-396.9149 520,-393.418 591.5953,-315.1122 489.644,-240.2102 556,-157.418 559.2968,-153.3046 563.5068,-149.9952 568.1179,-147.3332"/>
<polygon fill="#000000" stroke="#000000" points="569.8008,-150.409 577.3451,-142.9704 566.8086,-144.0807 569.8008,-150.409"/>
</g>
<!-- proc~analytical_profiles_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node16" class="node">
<title>proc~analytical_profiles_p</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node16"><a xlink:href=".././proc/analytical_profiles_p.html" xlink:title="analytical_profiles_p">
<polygon fill="#d9534f" stroke="#d9534f" points="664,-591.418 556,-591.418 556,-567.418 664,-567.418 664,-591.418"/>
<text text-anchor="middle" x="610" y="-577.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">analytical_profiles_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~analytical_profiles_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge19" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~analytical_profiles_p</title>
<path fill="none" stroke="#000000" d="M468.7341,-426.5198C486.122,-434.1758 506.3913,-445.642 520,-461.418 550.0361,-496.2375 523.7373,-525.6508 556,-558.418 557.0807,-559.5155 558.2252,-560.5569 559.4222,-561.5449"/>
<polygon fill="#000000" stroke="#000000" points="557.7167,-564.6168 567.9607,-567.3206 561.6387,-558.8186 557.7167,-564.6168"/>
</g>
<!-- proc~interp_focollision_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node17" class="node">
<title>proc~interp_focollision_p</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node17"><a xlink:href=".././proc/interp_focollision_p.html" xlink:title="interp_FOcollision_p">
<polygon fill="#d9534f" stroke="#d9534f" points="664,-549.418 556,-549.418 556,-525.418 664,-525.418 664,-549.418"/>
<text text-anchor="middle" x="610" y="-535.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interp_FOcollision_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~interp_focollision_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge20" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~interp_focollision_p</title>
<path fill="none" stroke="#000000" d="M464.5053,-426.4949C482.0462,-434.5714 503.842,-446.4577 520,-461.418 541.4376,-481.2664 533.3025,-498.0235 556,-516.418 557.7461,-517.8331 559.5988,-519.1611 561.5262,-520.4065"/>
<polygon fill="#000000" stroke="#000000" points="559.9205,-523.5188 570.3556,-525.3515 563.341,-517.4114 559.9205,-523.5188"/>
</g>
<!-- proc~get_random -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node18" class="node">
<title>proc~get_random</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node18"><a xlink:href=".././proc/get_random.html" xlink:title="get_random">
<polygon fill="#d94e8f" stroke="#d94e8f" points="644.5,-507.418 575.5,-507.418 575.5,-483.418 644.5,-483.418 644.5,-507.418"/>
<text text-anchor="middle" x="610" y="-493.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">get_random</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~get_random -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge21" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~get_random</title>
<path fill="none" stroke="#000000" d="M460.7741,-426.5445C490.974,-440.4829 540.6966,-463.4318 574.366,-478.9715"/>
<polygon fill="#000000" stroke="#000000" points="573.287,-482.3282 583.8333,-483.341 576.2204,-475.9725 573.287,-482.3282"/>
</g>
<!-- proc~ca_sd -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node19" class="node">
<title>proc~ca_sd</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node19"><a xlink:href=".././proc/ca_sd.html" xlink:title="CA_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="637,-190.418 583,-190.418 583,-166.418 637,-166.418 637,-190.418"/>
<text text-anchor="middle" x="610" y="-176.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CA_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~ca_sd -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge22" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~ca_sd</title>
<path fill="none" stroke="#000000" d="M509.0037,-402.2512C513.028,-399.7819 516.747,-396.8632 520,-393.418 580.2053,-329.6559 500.065,-266.9572 556,-199.418 560.5263,-193.9526 566.6588,-189.9047 573.1684,-186.9081"/>
<polygon fill="#000000" stroke="#000000" points="574.7332,-190.0575 582.8325,-183.2273 572.2416,-183.5159 574.7332,-190.0575"/>
</g>
<!-- proc~gammacee -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node24" class="node">
<title>proc~gammacee</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node24"><a xlink:href=".././proc/gammacee.html" xlink:title="Gammacee">
<polygon fill="#d94e8f" stroke="#d94e8f" points="812,-230.418 745,-230.418 745,-206.418 812,-206.418 812,-230.418"/>
<text text-anchor="middle" x="778.5" y="-216.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Gammacee</text>
</a>
</g>
</g>
<!-- proc~dca_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge24" class="edge">
<title>proc~dca_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M637.0724,-220.0966C663.4005,-219.7841 703.8336,-219.3042 734.7345,-218.9374"/>
<polygon fill="#000000" stroke="#000000" points="734.8567,-222.4363 744.8144,-218.8178 734.7735,-215.4368 734.8567,-222.4363"/>
</g>
<!-- proc~vte -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node27" class="node">
<title>proc~vte</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node27"><a xlink:href=".././proc/vte.html" xlink:title="VTe">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1037,-230.418 983,-230.418 983,-206.418 1037,-206.418 1037,-230.418"/>
<text text-anchor="middle" x="1010" y="-216.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VTe</text>
</a>
</g>
</g>
<!-- proc~dca_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge23" class="edge">
<title>proc~dca_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M637.2294,-211.5631C654.9048,-206.2897 678.5585,-200.1144 700,-197.418 797.9993,-185.0939 914.4007,-201.1425 972.7456,-211.2816"/>
<polygon fill="#000000" stroke="#000000" points="972.4881,-214.7907 982.9468,-213.0978 973.7151,-207.8991 972.4881,-214.7907"/>
</g>
<!-- proc~psi -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node29" class="node">
<title>proc~psi</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node29"><a xlink:href=".././proc/psi.html" xlink:title="psi">
<polygon fill="#d94e8f" stroke="#d94e8f" points="805.5,-150.418 751.5,-150.418 751.5,-126.418 805.5,-126.418 805.5,-150.418"/>
<text text-anchor="middle" x="778.5" y="-136.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">psi</text>
</a>
</g>
</g>
<!-- proc~dca_sd&#45;&gt;proc~psi -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge25" class="edge">
<title>proc~dca_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M637.117,-212.2819C646.0504,-208.9847 655.7912,-204.6923 664,-199.418 682.774,-187.3552 680.9242,-175.9976 700,-164.418 712.7393,-156.6847 728.0543,-150.9481 741.7616,-146.8603"/>
<polygon fill="#000000" stroke="#000000" points="742.7079,-150.23 751.3987,-144.1701 740.8258,-143.4877 742.7079,-150.23"/>
</g>
<!-- proc~clogee -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node20" class="node">
<title>proc~clogee</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node20"><a xlink:href=".././proc/clogee.html" xlink:title="CLogee">
<polygon fill="#d94e8f" stroke="#d94e8f" points="947,-350.418 893,-350.418 893,-326.418 947,-326.418 947,-350.418"/>
<text text-anchor="middle" x="920" y="-336.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CLogee</text>
</a>
</g>
</g>
<!-- proc~cf_sd&#45;&gt;proc~clogee -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge26" class="edge">
<title>proc~cf_sd&#45;&gt;proc~clogee</title>
<path fill="none" stroke="#000000" d="M632.2191,-292.4578C650.0121,-301.4981 675.8955,-313.3265 700,-319.418 762.7975,-335.2876 838.5311,-338.4858 882.7727,-338.826"/>
<polygon fill="#000000" stroke="#000000" points="882.7719,-342.3259 892.783,-338.8578 882.7942,-335.326 882.7719,-342.3259"/>
</g>
<!-- proc~cf_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge27" class="edge">
<title>proc~cf_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M637.01,-269.1166C654.7989,-261.7969 678.6601,-252.2118 700,-244.418 711.2644,-240.3039 723.5356,-236.1065 734.9571,-232.3181"/>
<polygon fill="#000000" stroke="#000000" points="736.3216,-235.5539 744.7289,-229.1066 734.136,-228.9038 736.3216,-235.5539"/>
</g>
<!-- proc~cf_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge28" class="edge">
<title>proc~cf_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M637.1791,-276.2052C707.0166,-265.3804 892.8466,-236.5767 972.6901,-224.201"/>
<polygon fill="#000000" stroke="#000000" points="973.4376,-227.627 982.7835,-222.6365 972.3653,-220.7096 973.4376,-227.627"/>
</g>
<!-- proc~cf_sd&#45;&gt;proc~psi -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge29" class="edge">
<title>proc~cf_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M629.1707,-268.3586C639.9334,-261.1625 653.3068,-251.4856 664,-241.418 682.3964,-224.0977 681.7692,-214.9125 700,-197.418 715.8798,-182.1794 735.706,-167.3065 751.4603,-156.3054"/>
<polygon fill="#000000" stroke="#000000" points="753.483,-159.1622 759.7428,-150.6143 749.5188,-153.3929 753.483,-159.1622"/>
</g>
<!-- proc~h_j -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node31" class="node">
<title>proc~h_j</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node31"><a xlink:href=".././proc/h_j.html" xlink:title="h_j">
<polygon fill="#d94e8f" stroke="#d94e8f" points="805.5,-310.418 751.5,-310.418 751.5,-286.418 805.5,-286.418 805.5,-310.418"/>
<text text-anchor="middle" x="778.5" y="-296.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h_j</text>
</a>
</g>
</g>
<!-- proc~cf_sd&#45;&gt;proc~h_j -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge30" class="edge">
<title>proc~cf_sd&#45;&gt;proc~h_j</title>
<path fill="none" stroke="#000000" d="M637.0724,-283.31C665.3228,-286.3278 709.8133,-291.0805 741.3416,-294.4485"/>
<polygon fill="#000000" stroke="#000000" points="741.1795,-297.951 751.4947,-295.5331 741.9231,-290.9906 741.1795,-297.951"/>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~clogee -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge32" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~clogee</title>
<path fill="none" stroke="#000000" d="M641.1433,-406.7828C698.6196,-392.6919 821.1167,-362.6603 882.8311,-347.5303"/>
<polygon fill="#000000" stroke="#000000" points="884.0283,-350.8406 892.9073,-345.0601 882.3615,-344.0419 884.0283,-350.8406"/>
</g>
<!-- proc~clogei -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node21" class="node">
<title>proc~clogei</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node21"><a xlink:href=".././proc/clogei.html" xlink:title="CLogei">
<polygon fill="#d94e8f" stroke="#d94e8f" points="947,-465.418 893,-465.418 893,-441.418 947,-441.418 947,-465.418"/>
<text text-anchor="middle" x="920" y="-451.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CLogei</text>
</a>
</g>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~clogei -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge31" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~clogei</title>
<path fill="none" stroke="#000000" d="M641.1927,-419.5936C658.4935,-422.3828 680.4104,-425.7824 700,-428.418 764.0551,-437.0358 838.8698,-445.1177 882.6795,-449.6501"/>
<polygon fill="#000000" stroke="#000000" points="882.5548,-453.1557 892.8604,-450.6972 883.271,-446.1924 882.5548,-453.1557"/>
</g>
<!-- proc~g_j -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node23" class="node">
<title>proc~g_j</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node23"><a xlink:href=".././proc/g_j.html" xlink:title="g_j">
<polygon fill="#d94e8f" stroke="#d94e8f" points="805.5,-504.418 751.5,-504.418 751.5,-480.418 805.5,-480.418 805.5,-504.418"/>
<text text-anchor="middle" x="778.5" y="-490.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">g_j</text>
</a>
</g>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~g_j -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge33" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~g_j</title>
<path fill="none" stroke="#000000" d="M628.3721,-426.5283C646.1584,-437.8874 674.1526,-454.8169 700,-466.418 713.2554,-472.3673 728.2985,-477.6762 741.6443,-481.9211"/>
<polygon fill="#000000" stroke="#000000" points="740.8738,-485.3462 751.4614,-484.9529 742.9394,-478.6579 740.8738,-485.3462"/>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge34" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M616.2234,-402.0707C629.35,-376.7883 661.8269,-318.0867 700,-277.418 714.8655,-261.5807 734.3778,-246.8937 750.2297,-236.1348"/>
<polygon fill="#000000" stroke="#000000" points="752.2073,-239.023 758.6069,-230.5794 748.3386,-233.1892 752.2073,-239.023"/>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge35" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M641.4715,-419.2854C707.0028,-427.524 859.2806,-436.5135 947,-359.418 983.0297,-327.7519 999.4694,-271.4819 1006.1034,-240.4627"/>
<polygon fill="#000000" stroke="#000000" points="1009.542,-241.1158 1008.057,-230.6255 1002.6761,-239.7522 1009.542,-241.1158"/>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge38" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M642.5281,-148.3483C649.6692,-151.1664 657.1432,-154.2716 664,-157.418 693.5074,-170.9577 726.0858,-188.5889 748.9225,-201.4117"/>
<polygon fill="#000000" stroke="#000000" points="747.3455,-204.5407 757.7733,-206.4147 750.7901,-198.4469 747.3455,-204.5407"/>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge37" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M642.7797,-127.6767C650.2942,-124.633 657.8674,-120.6283 664,-115.418 687.9908,-95.0352 673.2881,-71.0759 700,-54.418 793.3209,3.7783 857.2468,24.1428 947,-39.418 973.2726,-58.0235 996.1485,-152.5462 1005.5017,-196.2278"/>
<polygon fill="#000000" stroke="#000000" points="1002.1064,-197.0906 1007.5822,-206.1607 1008.9578,-195.6556 1002.1064,-197.0906"/>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~psi -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge39" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M642.8885,-136.8083C671.0372,-137.1424 711.5555,-137.6234 740.9667,-137.9725"/>
<polygon fill="#000000" stroke="#000000" points="741.2155,-141.4756 751.2564,-138.0946 741.2987,-134.4761 741.2155,-141.4756"/>
</g>
<!-- proc~delta -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node30" class="node">
<title>proc~delta</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node30"><a xlink:href=".././proc/delta.html" xlink:title="delta">
<polygon fill="#d94e8f" stroke="#d94e8f" points="947,-72.418 893,-72.418 893,-48.418 947,-48.418 947,-72.418"/>
<text text-anchor="middle" x="920" y="-58.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">delta</text>
</a>
</g>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~delta -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge36" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~delta</title>
<path fill="none" stroke="#000000" d="M642.5442,-125.8242C649.8294,-122.895 657.3603,-119.4061 664,-115.418 682.1004,-104.5459 680.6335,-92.8303 700,-84.418 760.0292,-58.3427 837.579,-56.3423 882.7541,-57.9229"/>
<polygon fill="#000000" stroke="#000000" points="882.828,-61.4292 892.969,-58.3616 883.1284,-54.4357 882.828,-61.4292"/>
</g>
<!-- ezspline_error -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node22" class="node">
<title>ezspline_error</title>
<polygon fill="#777777" stroke="#777777" points="818,-672.418 739,-672.418 739,-648.418 818,-648.418 818,-672.418"/>
<text text-anchor="middle" x="778.5" y="-658.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ezspline_error</text>
</g>
<!-- proc~interp_focollision_p&#45;&gt;ezspline_error -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge40" class="edge">
<title>proc~interp_focollision_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M651.2828,-549.4384C655.9113,-551.9139 660.2877,-554.8773 664,-558.418 692.5082,-585.6077 670.0467,-613.8289 700,-639.418 708.2099,-646.4317 718.5277,-651.1286 728.959,-654.2672"/>
<polygon fill="#000000" stroke="#000000" points="728.3739,-657.7303 738.9299,-656.8236 730.1125,-650.9497 728.3739,-657.7303"/>
</g>
<!-- ezspline_interp -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node28" class="node">
<title>ezspline_interp</title>
<polygon fill="#777777" stroke="#777777" points="820,-630.418 737,-630.418 737,-606.418 820,-606.418 820,-630.418"/>
<text text-anchor="middle" x="778.5" y="-616.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ezspline_interp</text>
</g>
<!-- proc~interp_focollision_p&#45;&gt;ezspline_interp -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge42" class="edge">
<title>proc~interp_focollision_p&#45;&gt;ezspline_interp</title>
<path fill="none" stroke="#000000" d="M647.7207,-549.5215C653.3965,-552.0604 659.0124,-555.0194 664,-558.418 683.4937,-571.701 679.8086,-585.2215 700,-597.418 708.2454,-602.3985 717.677,-606.2162 727.0753,-609.137"/>
<polygon fill="#000000" stroke="#000000" points="726.2325,-612.5356 736.8062,-611.8673 728.1235,-605.7959 726.2325,-612.5356"/>
</g>
<!-- proc~check_if_in_profiles_domain_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node32" class="node">
<title>proc~check_if_in_profiles_domain_p</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node32"><a xlink:href=".././proc/check_if_in_profiles_domain_p.html" xlink:title="check_if_in_profiles_domain_p">
<polygon fill="#d9534f" stroke="#d9534f" points="857,-714.418 700,-714.418 700,-690.418 857,-690.418 857,-714.418"/>
<text text-anchor="middle" x="778.5" y="-700.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">check_if_in_profiles_domain_p</text>
</a>
</g>
</g>
<!-- proc~interp_focollision_p&#45;&gt;proc~check_if_in_profiles_domain_p -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge41" class="edge">
<title>proc~interp_focollision_p&#45;&gt;proc~check_if_in_profiles_domain_p</title>
<path fill="none" stroke="#000000" d="M652.5525,-549.4335C656.7977,-551.8979 660.7361,-554.86 664,-558.418 702.5048,-600.392 659.256,-641.6138 700,-681.418 701.2488,-682.638 702.5603,-683.7891 703.9255,-684.8751"/>
<polygon fill="#000000" stroke="#000000" points="702.0015,-687.7988 712.2694,-690.4103 705.8711,-681.9656 702.0015,-687.7988"/>
</g>
<!-- omp_get_thread_num -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node25" class="node">
<title>omp_get_thread_num</title>
<polygon fill="#777777" stroke="#777777" points="836,-546.418 721,-546.418 721,-522.418 836,-522.418 836,-546.418"/>
<text text-anchor="middle" x="778.5" y="-532.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">omp_get_thread_num</text>
</g>
<!-- proc~get_random&#45;&gt;omp_get_thread_num -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge44" class="edge">
<title>proc~get_random&#45;&gt;omp_get_thread_num</title>
<path fill="none" stroke="#000000" d="M644.5051,-503.4043C665.2379,-508.203 692.2324,-514.451 716.5545,-520.0804"/>
<polygon fill="#000000" stroke="#000000" points="715.9004,-523.5215 726.4321,-522.3666 717.4789,-516.7018 715.9004,-523.5215"/>
</g>
<!-- interface~random_get_number_u -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node26" class="node">
<title>interface~random_get_number_u</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node26"><a xlink:href=".././interface/random_get_number_u.html" xlink:title="random_get_number_U">
<polygon fill="#a7506f" stroke="#a7506f" points="840,-588.418 717,-588.418 717,-564.418 840,-564.418 840,-588.418"/>
<text text-anchor="middle" x="778.5" y="-574.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">random_get_number_U</text>
</a>
</g>
</g>
<!-- proc~get_random&#45;&gt;interface~random_get_number_u -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge43" class="edge">
<title>proc~get_random&#45;&gt;interface~random_get_number_u</title>
<path fill="none" stroke="#000000" d="M644.5965,-506.1674C651.3162,-508.9902 658.0981,-512.3964 664,-516.418 683.4937,-529.701 679.8086,-543.2215 700,-555.418 702.9887,-557.2233 706.1333,-558.8758 709.3756,-560.3882"/>
<polygon fill="#000000" stroke="#000000" points="708.1472,-563.6681 718.7238,-564.29 710.8436,-557.2082 708.1472,-563.6681"/>
</g>
<!-- proc~ca_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge46" class="edge">
<title>proc~ca_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M637.0724,-184.8447C663.4005,-191.0946 703.8336,-200.693 734.7345,-208.0285"/>
<polygon fill="#000000" stroke="#000000" points="734.2763,-211.517 744.8144,-210.4214 735.8932,-204.7062 734.2763,-211.517"/>
</g>
<!-- proc~ca_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge45" class="edge">
<title>proc~ca_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M637.0492,-170.6961C646.0743,-167.4106 655.8888,-163.0201 664,-157.418 683.6799,-143.8257 678.1513,-127.1485 700,-117.418 763.742,-89.0297 790.1705,-97.3491 857,-117.418 910.3173,-133.4291 962.1993,-174.7085 989.7187,-199.2543"/>
<polygon fill="#000000" stroke="#000000" points="987.6991,-202.1485 997.4517,-206.2882 992.4092,-196.9702 987.6991,-202.1485"/>
</g>
<!-- proc~ca_sd&#45;&gt;proc~psi -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge47" class="edge">
<title>proc~ca_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M637.0724,-171.9913C665.4457,-165.2558 710.2005,-154.6315 741.7521,-147.1415"/>
<polygon fill="#000000" stroke="#000000" points="742.5736,-150.5438 751.4947,-144.8287 740.9567,-143.7331 742.5736,-150.5438"/>
</g>
<!-- proc~clogee&#45;&gt;proc~vte -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge49" class="edge">
<title>proc~clogee&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M929.2926,-326.0278C944.8002,-305.3511 976.0975,-263.6213 994.8347,-238.6384"/>
<polygon fill="#000000" stroke="#000000" points="997.692,-240.662 1000.892,-230.562 992.0919,-236.462 997.692,-240.662"/>
</g>
<!-- proc~clog0 -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_node33" class="node">
<title>proc~clog0</title>
<g id="a_proc~~adv_fom3dc1_top~~CallsGraph_node33"><a xlink:href=".././proc/clog0.html" xlink:title="CLog0">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1037,-407.418 983,-407.418 983,-383.418 1037,-383.418 1037,-407.418"/>
<text text-anchor="middle" x="1010" y="-393.018" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CLog0</text>
</a>
</g>
</g>
<!-- proc~clogee&#45;&gt;proc~clog0 -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge48" class="edge">
<title>proc~clogee&#45;&gt;proc~clog0</title>
<path fill="none" stroke="#000000" d="M939.0867,-350.5062C951.6156,-358.4412 968.2098,-368.9509 982.1957,-377.8086"/>
<polygon fill="#000000" stroke="#000000" points="980.6199,-380.9535 990.9408,-383.3472 984.3653,-375.0397 980.6199,-380.9535"/>
</g>
<!-- proc~clogei&#45;&gt;proc~vte -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge51" class="edge">
<title>proc~clogei&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M935.2017,-441.3679C939.5132,-437.3213 943.8783,-432.5266 947,-427.418 984.5698,-365.9358 1001.084,-280.4987 1007.0953,-240.5997"/>
<polygon fill="#000000" stroke="#000000" points="1010.5727,-241.0057 1008.521,-230.6115 1003.6429,-240.0165 1010.5727,-241.0057"/>
</g>
<!-- proc~clogei&#45;&gt;proc~clog0 -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge50" class="edge">
<title>proc~clogei&#45;&gt;proc~clog0</title>
<path fill="none" stroke="#000000" d="M938.6481,-441.4003C951.4395,-433.157 968.617,-422.087 982.9124,-412.8744"/>
<polygon fill="#000000" stroke="#000000" points="984.8661,-415.7793 991.3758,-407.4202 981.0741,-409.8953 984.8661,-415.7793"/>
</g>
<!-- proc~gammacee&#45;&gt;proc~clogee -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge52" class="edge">
<title>proc~gammacee&#45;&gt;proc~clogee</title>
<path fill="none" stroke="#000000" d="M795.8192,-230.4856C812.0508,-242.0142 836.777,-260.1446 857,-277.418 872.5304,-290.6832 889.0849,-306.7974 901.3251,-319.1316"/>
<polygon fill="#000000" stroke="#000000" points="898.8331,-321.5893 908.3411,-326.2636 903.8233,-316.6803 898.8331,-321.5893"/>
</g>
<!-- proc~delta&#45;&gt;proc~vte -->
<g id="proc~~adv_fom3dc1_top~~CallsGraph_edge53" class="edge">
<title>proc~delta&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M934.4539,-72.5153C938.8313,-76.6331 943.422,-81.4565 947,-86.418 972.569,-121.8736 992.2383,-169.3344 1002.3803,-196.6217"/>
<polygon fill="#000000" stroke="#000000" points="999.2074,-198.1389 1005.907,-206.3466 1005.7881,-195.7524 999.2074,-198.1389"/>
</g>
</g>
</svg>
</div><script>var panprocadv_fom3dc1_topCallsGraph = svgPanZoom('#procadv_fom3dc1_topCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="554pt" height="32pt"
 viewBox="0.00 0.00 553.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 549.5,-28 549.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="63,-24 0,-24 0,0 63,0 63,-24"/>
<text text-anchor="middle" x="31.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="135.5,-24 81.5,-24 81.5,0 135.5,0 135.5,-24"/>
<text text-anchor="middle" x="108.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="207.5,-24 153.5,-24 153.5,0 207.5,0 207.5,-24"/>
<text text-anchor="middle" x="180.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="359.5,-24 225.5,-24 225.5,0 359.5,0 359.5,-24"/>
<text text-anchor="middle" x="292.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="431.5,-24 377.5,-24 377.5,0 431.5,0 431.5,-24"/>
<text text-anchor="middle" x="404.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="545.5,-24 449.5,-24 449.5,0 545.5,0 545.5,-24"/>
<text text-anchor="middle" x="497.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~adv_fom3dc1_top~~CalledByGraph Pages: 1 -->
<svg id="procadv_fom3dc1_topCalledByGraph" width="200pt" height="32pt"
 viewBox="0.00 0.00 200.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~adv_fom3dc1_top~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~adv_fom3dc1_top~~CalledByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 196,-28 196,4 -4,4"/>
<!-- proc~adv_fom3dc1_top -->
<g id="proc~~adv_fom3dc1_top~~CalledByGraph_node1" class="node">
<title>proc~adv_fom3dc1_top</title>
<polygon fill="none" stroke="#000000" points="192,-24 90,-24 90,0 192,0 192,-24"/>
<text text-anchor="middle" x="141" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">adv_FOm3dc1_top</text>
</g>
<!-- program~main -->
<g id="proc~~adv_fom3dc1_top~~CalledByGraph_node2" class="node">
<title>program~main</title>
<g id="a_proc~~adv_fom3dc1_top~~CalledByGraph_node2"><a xlink:href=".././program/main.html" xlink:title="main">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main</text>
</a>
</g>
</g>
<!-- program~main&#45;&gt;proc~adv_fom3dc1_top -->
<g id="proc~~adv_fom3dc1_top~~CalledByGraph_edge1" class="edge">
<title>program~main&#45;&gt;proc~adv_fom3dc1_top</title>
<path fill="none" stroke="#000000" d="M54.0164,-12C61.7663,-12 70.5499,-12 79.4824,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.5837,-15.5001 89.5837,-12 79.5836,-8.5001 79.5837,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="554pt" height="32pt"
 viewBox="0.00 0.00 553.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 549.5,-28 549.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="63,-24 0,-24 0,0 63,0 63,-24"/>
<text text-anchor="middle" x="31.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="135.5,-24 81.5,-24 81.5,0 135.5,0 135.5,-24"/>
<text text-anchor="middle" x="108.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="207.5,-24 153.5,-24 153.5,0 207.5,0 207.5,-24"/>
<text text-anchor="middle" x="180.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="359.5,-24 225.5,-24 225.5,0 359.5,0 359.5,-24"/>
<text text-anchor="middle" x="292.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="431.5,-24 377.5,-24 377.5,0 431.5,0 431.5,-24"/>
<text text-anchor="middle" x="404.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="545.5,-24 449.5,-24 449.5,0 545.5,0 545.5,-24"/>
<text text-anchor="middle" x="497.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/adv_fom3dc1_top.html#src">adv_FOm3dc1_top</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">adv_FOm3dc1_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">spp</span><span class="p">)</span>  
    <span class="k">TYPE</span><span class="p">(</span><span class="n">KORC_PARAMS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>                           <span class="kd">::</span> <span class="n">params</span>
    <span class="c">!! Core KORC simulation parameters.</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">FIELDS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                                   <span class="kd">::</span> <span class="n">F</span>
    <span class="c">!! An instance of the KORC derived type FIELDS.</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">PROFILES</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                                 <span class="kd">::</span> <span class="n">P</span>
    <span class="c">!! An instance of the KORC derived type PROFILES.</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">SPECIES</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">spp</span>
    <span class="c">!! An instance of the derived type SPECIES containing all the parameters</span>
    <span class="c">!! and simulation variables of the different species in the simulation.</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">Bmag</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">b_unit_X</span><span class="p">,</span><span class="n">b_unit_Y</span><span class="p">,</span><span class="n">b_unit_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">v</span><span class="p">,</span><span class="n">vpar</span><span class="p">,</span><span class="n">vperp</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">tmp</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">g</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">cross_X</span><span class="p">,</span><span class="n">cross_Y</span><span class="p">,</span><span class="n">cross_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">vec_X</span><span class="p">,</span><span class="n">vec_Y</span><span class="p">,</span><span class="n">vec_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X_X</span><span class="p">,</span><span class="n">X_Y</span><span class="p">,</span><span class="n">X_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">V_X</span><span class="p">,</span><span class="n">V_Y</span><span class="p">,</span><span class="n">V_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B_X</span><span class="p">,</span><span class="n">B_Y</span><span class="p">,</span><span class="n">B_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">E_X</span><span class="p">,</span><span class="n">E_Y</span><span class="p">,</span><span class="n">E_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PSIp</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="kt">C_PTR</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hint</span>
    <span class="kt">INTEGER</span><span class="p">(</span><span class="k">is</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flagCon</span><span class="p">,</span><span class="n">flagCol</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span><span class="p">,</span><span class="n">m_cache</span><span class="p">,</span><span class="n">q_cache</span>    
    <span class="kt">INTEGER</span>                                                    <span class="kd">::</span> <span class="n">ii</span>
    <span class="c">!! Species iterator.</span>
    <span class="kt">INTEGER</span>                                                    <span class="kd">::</span> <span class="n">pp</span><span class="p">,</span><span class="n">pchunk</span>
    <span class="c">!! Particles iterator.</span>
    <span class="kt">INTEGER</span>                                                    <span class="kd">::</span> <span class="n">cc</span>
    <span class="c">!! Chunk iterator.</span>
    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>                                                    <span class="kd">::</span> <span class="n">tt</span>
    <span class="c">!! time iterator.</span>


    <span class="k">do </span><span class="n">ii</span> <span class="o">=</span> <span class="mi">1_idef</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">num_species</span>      

       <span class="n">pchunk</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span>
       <span class="n">m_cache</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">m</span>
       <span class="n">q_cache</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">q</span>
       <span class="n">a</span> <span class="o">=</span> <span class="n">q_cache</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span><span class="o">/</span><span class="n">m_cache</span>


       <span class="c">!$OMP PARALLEL DO default(none) &amp;</span>
       <span class="c">!$OMP&amp; FIRSTPRIVATE(a,m_cache,q_cache,E0,pchunk) &amp;</span>
       <span class="c">!$OMP&amp; shared(params,ii,spp,P,F) &amp;</span>
       <span class="c">!$OMP&amp; PRIVATE(pp,tt,Bmag,cc,X_X,X_Y,X_Z,V_X,V_Y,V_Z,B_X,B_Y,B_Z, &amp;</span>
       <span class="c">!$OMP&amp; E_X,E_Y,E_Z,b_unit_X,b_unit_Y,b_unit_Z,v,vpar,vperp,tmp, &amp;</span>
       <span class="c">!$OMP&amp; cross_X,cross_Y,cross_Z,vec_X,vec_Y,vec_Z,g, &amp;</span>
       <span class="c">!$OMP&amp; Y_R,Y_PHI,Y_Z,flagCon,flagCol,PSIp,hint)</span>
       <span class="k">do </span><span class="n">pp</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">ppp</span><span class="p">,</span><span class="n">pchunk</span>

          <span class="c">!$OMP SIMD</span>
          <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>
             <span class="n">X_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
             <span class="n">X_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
             <span class="n">X_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

             <span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
             <span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
             <span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

             <span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
             <span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
             <span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

             <span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
             <span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
             <span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

             <span class="n">PSIp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">PSI_P</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">hint</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">hint</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">g</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">flagCon</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCon</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">flagCol</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCol</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">end do</span>
          <span class="c">!$OMP END SIMD</span>

          <span class="c">!write(output_unit_write,*) &#39;Yin: &#39;,Y_R,Y_PHI,Y_Z</span>
          <span class="c">!write(output_unit_write,*) &#39;Bin: &#39;,B_X,B_Y,B_Z</span>


          <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">FokPlan</span><span class="p">)</span> <span class="k">then</span>
<span class="k">             do </span><span class="n">tt</span><span class="o">=</span><span class="mi">1_ip</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>

                <span class="k">call </span><span class="n">cart_to_cyl_p</span><span class="p">(</span><span class="n">pchunk</span><span class="p">,</span><span class="n">X_X</span><span class="p">,</span><span class="n">X_Y</span><span class="p">,</span><span class="n">X_Z</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">)</span>

                <span class="k">call </span><span class="n">get_m3d_c1_FOmagnetic_fields_p</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">B_X</span><span class="p">,</span><span class="n">B_Y</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">hint</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">F</span><span class="p">%</span><span class="n">M3D_C1_E</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                   call </span><span class="n">get_m3d_c1_FOelectric_fields_p</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span><span class="n">E_X</span><span class="p">,</span><span class="n">E_Y</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">hint</span><span class="p">)</span>
                <span class="k">end if</span>
<span class="k">                call </span><span class="n">get_m3d_c1_vector_potential_p</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">PSIp</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">hint</span><span class="p">)</span>

                <span class="k">call </span><span class="n">advance_FOm3dc1_vars</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">q_cache</span><span class="p">,</span><span class="n">m_cache</span><span class="p">,</span><span class="n">params</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">X_X</span><span class="p">,</span><span class="n">X_Y</span><span class="p">,</span><span class="n">X_Z</span><span class="p">,</span><span class="n">V_X</span><span class="p">,</span><span class="n">V_Y</span><span class="p">,</span><span class="n">V_Z</span><span class="p">,</span><span class="n">B_X</span><span class="p">,</span><span class="n">B_Y</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span><span class="n">E_X</span><span class="p">,</span><span class="n">E_Y</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">g</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">flagCol</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">PSIp</span><span class="p">)</span>

             <span class="k">end do</span> <span class="c">!timestep iterator</span>

             <span class="k">call </span><span class="n">cart_to_cyl_p</span><span class="p">(</span><span class="n">pchunk</span><span class="p">,</span><span class="n">X_X</span><span class="p">,</span><span class="n">X_Y</span><span class="p">,</span><span class="n">X_Z</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">)</span>

             <span class="k">call </span><span class="n">get_m3d_c1_vector_potential_p</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">PSIp</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">hint</span><span class="p">)</span>

             <span class="c">!write(output_unit_write,*) &#39;Yout: &#39;,Y_R,Y_PHI,Y_Z</span>
             <span class="c">!write(output_unit_write,*) &#39;Bout: &#39;,B_X,B_Y,B_Z</span>



             <span class="c">!$OMP SIMD</span>
             <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">X_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">X_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">X_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Y</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">Y_R</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Y</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">Y_PHI</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Y</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">Y_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">g</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCon</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">flagCon</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCol</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">flagCol</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">PSI_P</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">PSIp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">hint</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">hint</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="k">end do</span>
             <span class="c">!$OMP END SIMD</span>

          <span class="k">else</span>
             <span class="c">!$OMP SIMD</span>
             <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>
                <span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

                <span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
             <span class="k">end do</span>
             <span class="c">!$OMP END SIMD</span>

             <span class="k">call </span><span class="n">advance_FP3Dinterp_vars</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">X_X</span><span class="p">,</span><span class="n">X_Y</span><span class="p">,</span><span class="n">X_Z</span><span class="p">,</span><span class="n">V_X</span><span class="p">,</span><span class="n">V_Y</span><span class="p">,</span><span class="n">V_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">g</span><span class="p">,</span><span class="n">m_cache</span><span class="p">,</span><span class="n">B_X</span><span class="p">,</span><span class="n">B_Y</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span><span class="n">E_X</span><span class="p">,</span><span class="n">E_Y</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">flagCol</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">PSIp</span><span class="p">)</span>

             <span class="c">!$OMP SIMD</span>
             <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">g</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCol</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">flagCol</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

             <span class="k">end do</span>
             <span class="c">!$OMP END SIMD</span>
          <span class="k">end if</span>

          <span class="c">!$OMP SIMD</span>
          <span class="c">!          !$OMP&amp; aligned(Bmag,B_X,B_Y,B_Z, &amp;</span>
          <span class="c">!          !$OMP&amp; b_unit_X,b_unit_Y,b_unit_Z,v,V_X,V_Y,V_Z,vpar, &amp;</span>
          <span class="c">!          !$OMP&amp; vperp,tmp,cross_X,cross_Y,cross_Z, &amp;</span>
          <span class="c">!          !$OMP&amp; vec_X,vec_Y,vec_Z,E_X,E_Y,E_Z)</span>
          <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>
             <span class="c">!Derived output data</span>
             <span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>

             <span class="c">! Parallel unit vector</span>
             <span class="n">b_unit_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">b_unit_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">b_unit_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
             <span class="k">if</span> <span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">).</span><span class="n">GT</span><span class="p">.</span><span class="n">korc_zero</span><span class="p">)</span> <span class="k">then</span>
                <span class="c">! Parallel and perpendicular components of velocity</span>
                <span class="n">vpar</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">b_unit_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">b_unit_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">b_unit_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>

                <span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span>  <span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">vpar</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
                <span class="k">if</span> <span class="p">(</span> <span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">korc_zero</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                   </span><span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span> <span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="p">)</span>
                <span class="k">else</span>
<span class="k">                   </span><span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
                <span class="k">end if</span>

                <span class="c">! Pitch angle</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">eta</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mi">18</span><span class="mf">0.0_rp</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="nb">MODULO</span><span class="p">(</span><span class="n">ATAN2</span><span class="p">(</span><span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">vpar</span><span class="p">(</span><span class="n">cc</span><span class="p">)),</span><span class="mf">2.0_rp</span><span class="o">*</span><span class="n">C_PI</span><span class="p">)</span><span class="o">/</span><span class="n">C_PI</span>

                <span class="c">! Magnetic moment</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">mu</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5_rp</span><span class="o">*</span><span class="n">m_cache</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="c">! See Northrop&#39;s book (The adiabatic motion of charged</span>
                <span class="c">! particles)</span>

                <span class="c">! Radiated power</span>
                <span class="n">tmp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">q_cache</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="mf">6.0_rp</span><span class="o">*</span><span class="n">C_PI</span><span class="o">*</span><span class="n">E0</span><span class="o">*</span><span class="n">m_cache</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

                <span class="n">cross_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">-</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">cross_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">-</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">cross_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">-</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">vec_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="n">cross_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">vec_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="n">cross_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">vec_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="n">cross_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Prad</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="p">(</span> <span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">cross_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">cross_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">cross_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="p">((</span><span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="p">&amp;</span>
                     <span class="o">-</span> <span class="n">vec_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">vec_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">vec_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">vec_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">vec_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">vec_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span> <span class="p">)</span>

                <span class="c">! Input power due to electric field</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Pin</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">q_cache</span><span class="o">*</span><span class="p">(</span><span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
             <span class="k">else</span>
<span class="k">                </span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">eta</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">mu</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Prad</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Pin</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
             <span class="k">end if</span>

<span class="k">          end do</span>
          <span class="c">!$OMP END SIMD</span>


       <span class="k">end do</span> <span class="c">!particle chunk iterator</span>
       <span class="c">!$OMP END PARALLEL DO</span>

    <span class="k">end do</span> <span class="c">!species iterator</span>

  <span class="k">end subroutine </span><span class="n">adv_FOm3dc1_top</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> KORC was developed by Matt Beidler</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>