<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Kinetic Orbit Runaway electrons Code (KORC)">
    
    <meta name="author" content="Matt Beidler" >
    <link rel="icon" href="../favicon.png">

    <title>adv_FOinterp_top &ndash; KORC</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">KORC </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>README</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>adv_FOinterp_top
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.6% of total for procedures.">123 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/korc_ppusher.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/korc_ppusher.f90.html'>korc_ppusher.f90</a></li>
    
     <li><a href='../module/korc_ppusher.html'>korc_ppusher</a></li>
    
  
     <li class="active">adv_FOinterp_top</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/adv_fointerp_top.html#src">adv_FOinterp_top</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine adv_FOinterp_top(params, F, P, spp)
    
    
   
</h2>
    
  


    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-params~70"></span>type(KORC_PARAMS),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>params</strong></td><td><p>Core KORC simulation parameters.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f~20"></span>type(FIELDS),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>F</strong></td><td><p>An instance of the KORC derived type FIELDS.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-p~23"></span>type(PROFILES),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>P</strong></td><td><p>An instance of the KORC derived type PROFILES.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-spp~27"></span>type(SPECIES),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>spp</strong></td><td><p>An instance of the derived type SPECIES containing all the parameters
 and simulation variables of the different species in the simulation.</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~adv_fointerp_top~~CallsGraph Pages: 1 -->
<svg id="procadv_fointerp_topCallsGraph" width="641pt" height="508pt"
 viewBox="0.00 0.00 641.00 507.78" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~adv_fointerp_top~~CallsGraph" class="graph" transform="scale(.6158 .6158) rotate(0) translate(4 820.6509)">
<title>proc~~adv_fointerp_top~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-820.6509 1037,-820.6509 1037,4 -4,4"/>
<!-- proc~adv_fointerp_top -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node1" class="node">
<title>proc~adv_fointerp_top</title>
<polygon fill="none" stroke="#000000" points="97,-436 0,-436 0,-412 97,-412 97,-436"/>
<text text-anchor="middle" x="48.5" y="-421.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">adv_FOinterp_top</text>
</g>
<!-- proc~interp_fofields1_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node2" class="node">
<title>proc~interp_fofields1_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node2"><a xlink:href=".././proc/interp_fofields1_p.html" xlink:title="interp_FOfields1_p">
<polygon fill="#d9534f" stroke="#d9534f" points="442,-751 341,-751 341,-727 442,-727 442,-751"/>
<text text-anchor="middle" x="391.5" y="-736.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interp_FOfields1_p</text>
</a>
</g>
</g>
<!-- proc~adv_fointerp_top&#45;&gt;proc~interp_fofields1_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge1" class="edge">
<title>proc~adv_fointerp_top&#45;&gt;proc~interp_fofields1_p</title>
<path fill="none" stroke="#000000" d="M56.4951,-436.3322C70.5535,-457.5386 101.2352,-501.7408 133,-534 209.8006,-611.996 315.9915,-687.7836 364.894,-721.1951"/>
<polygon fill="#000000" stroke="#000000" points="363.0998,-724.2074 373.3384,-726.9316 367.0333,-718.4171 363.0998,-724.2074"/>
</g>
<!-- proc~advance_fp3dinterp_vars -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node3" class="node">
<title>proc~advance_fp3dinterp_vars</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node3"><a xlink:href=".././proc/advance_fp3dinterp_vars.html" xlink:title="advance_FP3Dinterp_vars">
<polygon fill="#d9534f" stroke="#d9534f" points="270,-436 133,-436 133,-412 270,-412 270,-436"/>
<text text-anchor="middle" x="201.5" y="-421.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advance_FP3Dinterp_vars</text>
</a>
</g>
</g>
<!-- proc~adv_fointerp_top&#45;&gt;proc~advance_fp3dinterp_vars -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge2" class="edge">
<title>proc~adv_fointerp_top&#45;&gt;proc~advance_fp3dinterp_vars</title>
<path fill="none" stroke="#000000" d="M97.3308,-424C105.4395,-424 114.0274,-424 122.6552,-424"/>
<polygon fill="#000000" stroke="#000000" points="122.7754,-427.5001 132.7754,-424 122.7753,-420.5001 122.7754,-427.5001"/>
</g>
<!-- proc~interp_fofields_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node4" class="node">
<title>proc~interp_fofields_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node4"><a xlink:href=".././proc/interp_fofields_p.html" xlink:title="interp_FOfields_p">
<polygon fill="#d9534f" stroke="#d9534f" points="439,-652 344,-652 344,-628 439,-628 439,-652"/>
<text text-anchor="middle" x="391.5" y="-637.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interp_FOfields_p</text>
</a>
</g>
</g>
<!-- proc~adv_fointerp_top&#45;&gt;proc~interp_fofields_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge3" class="edge">
<title>proc~adv_fointerp_top&#45;&gt;proc~interp_fofields_p</title>
<path fill="none" stroke="#000000" d="M67.9239,-436.232C125.5837,-472.5425 295.9349,-579.819 363.4651,-622.3454"/>
<polygon fill="#000000" stroke="#000000" points="361.9621,-625.535 372.2891,-627.9022 365.6923,-619.6117 361.9621,-625.535"/>
</g>
<!-- proc~advance_fointerp_vars -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node5" class="node">
<title>proc~advance_fointerp_vars</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node5"><a xlink:href=".././proc/advance_fointerp_vars.html" xlink:title="advance_FOinterp_vars">
<polygon fill="#d9534f" stroke="#d9534f" points="264,-394 139,-394 139,-370 264,-370 264,-394"/>
<text text-anchor="middle" x="201.5" y="-379.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advance_FOinterp_vars</text>
</a>
</g>
</g>
<!-- proc~adv_fointerp_top&#45;&gt;proc~advance_fointerp_vars -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge4" class="edge">
<title>proc~adv_fointerp_top&#45;&gt;proc~advance_fointerp_vars</title>
<path fill="none" stroke="#000000" d="M92.3437,-411.9645C109.629,-407.2195 129.6527,-401.7228 147.7943,-396.7427"/>
<polygon fill="#000000" stroke="#000000" points="148.9332,-400.0597 157.6499,-394.0373 147.0801,-393.3094 148.9332,-400.0597"/>
</g>
<!-- cart_to_cyl_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node6" class="node">
<title>cart_to_cyl_p</title>
<polygon fill="#777777" stroke="#777777" points="624,-140 549,-140 549,-116 624,-116 624,-140"/>
<text text-anchor="middle" x="586.5" y="-125.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cart_to_cyl_p</text>
</g>
<!-- proc~adv_fointerp_top&#45;&gt;cart_to_cyl_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge5" class="edge">
<title>proc~adv_fointerp_top&#45;&gt;cart_to_cyl_p</title>
<path fill="none" stroke="#000000" d="M63.3346,-411.9999C79.8808,-398.8409 107.6586,-377.4141 133,-361 295.3191,-255.863 334.3933,-223.1682 513,-149 521.2816,-145.561 530.312,-142.4744 539.1189,-139.7937"/>
<polygon fill="#000000" stroke="#000000" points="540.2919,-143.0976 548.9155,-136.9425 538.3358,-136.3765 540.2919,-143.0976"/>
</g>
<!-- ezspline_error -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node7" class="node">
<title>ezspline_error</title>
<polygon fill="#777777" stroke="#777777" points="814,-738 735,-738 735,-714 814,-714 814,-738"/>
<text text-anchor="middle" x="774.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ezspline_error</text>
</g>
<!-- proc~interp_fofields1_p&#45;&gt;ezspline_error -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge7" class="edge">
<title>proc~interp_fofields1_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M409.0038,-751.1099C431.7489,-766.038 473.2669,-790.5858 513,-800 576.5732,-815.0628 600.6438,-827.3 660,-800 682.3362,-789.7268 676.0567,-772.3774 696,-758 704.8662,-751.6083 715.1946,-746.232 725.3907,-741.8199"/>
<polygon fill="#000000" stroke="#000000" points="726.732,-745.0528 734.6715,-738.0375 724.0901,-738.5704 726.732,-745.0528"/>
</g>
<!-- ezspline_interp -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node8" class="node">
<title>ezspline_interp</title>
<polygon fill="#777777" stroke="#777777" points="816,-673 733,-673 733,-649 816,-649 816,-673"/>
<text text-anchor="middle" x="774.5" y="-658.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ezspline_interp</text>
</g>
<!-- proc~interp_fofields1_p&#45;&gt;ezspline_interp -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge8" class="edge">
<title>proc~interp_fofields1_p&#45;&gt;ezspline_interp</title>
<path fill="none" stroke="#000000" d="M442.0142,-741.4146C496.7664,-742.6613 586.2037,-740.68 660,-720 677.0244,-715.2292 716.7021,-693.8422 744.5531,-678.1859"/>
<polygon fill="#000000" stroke="#000000" points="746.5139,-681.098 753.495,-673.1284 743.0677,-675.005 746.5139,-681.098"/>
</g>
<!-- proc~calculate_magnetic_field_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node9" class="node">
<title>proc~calculate_magnetic_field_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node9"><a xlink:href=".././proc/calculate_magnetic_field_p.html" xlink:title="calculate_magnetic_field_p">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-791 517,-791 517,-767 656,-767 656,-791"/>
<text text-anchor="middle" x="586.5" y="-776.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">calculate_magnetic_field_p</text>
</a>
</g>
</g>
<!-- proc~interp_fofields1_p&#45;&gt;proc~calculate_magnetic_field_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge6" class="edge">
<title>proc~interp_fofields1_p&#45;&gt;proc~calculate_magnetic_field_p</title>
<path fill="none" stroke="#000000" d="M442.2249,-749.4051C465.2351,-754.1251 492.8004,-759.7796 517.6432,-764.8755"/>
<polygon fill="#000000" stroke="#000000" points="517.238,-768.3652 527.7374,-766.9461 518.6447,-761.508 517.238,-768.3652"/>
</g>
<!-- proc~check_if_in_fields_domain_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node12" class="node">
<title>proc~check_if_in_fields_domain_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node12"><a xlink:href=".././proc/check_if_in_fields_domain_p.html" xlink:title="check_if_in_fields_domain_p">
<polygon fill="#d9534f" stroke="#d9534f" points="660,-711 513,-711 513,-687 660,-687 660,-711"/>
<text text-anchor="middle" x="586.5" y="-696.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">check_if_in_fields_domain_p</text>
</a>
</g>
</g>
<!-- proc~interp_fofields1_p&#45;&gt;proc~check_if_in_fields_domain_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge9" class="edge">
<title>proc~interp_fofields1_p&#45;&gt;proc~check_if_in_fields_domain_p</title>
<path fill="none" stroke="#000000" d="M442.2249,-728.5949C465.2351,-723.8749 492.8004,-718.2204 517.6432,-713.1245"/>
<polygon fill="#000000" stroke="#000000" points="518.6447,-716.492 527.7374,-711.0539 517.238,-709.6348 518.6447,-716.492"/>
</g>
<!-- proc~include_coulombcollisions_fo_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node10" class="node">
<title>proc~include_coulombcollisions_fo_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node10"><a xlink:href=".././proc/include_coulombcollisions_fo_p.html" xlink:title="include_CoulombCollisions_FO_p">
<polygon fill="#d9534f" stroke="#d9534f" points="477,-425 306,-425 306,-401 477,-401 477,-425"/>
<text text-anchor="middle" x="391.5" y="-410.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">include_CoulombCollisions_FO_p</text>
</a>
</g>
</g>
<!-- proc~advance_fp3dinterp_vars&#45;&gt;proc~include_coulombcollisions_fo_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge10" class="edge">
<title>proc~advance_fp3dinterp_vars&#45;&gt;proc~include_coulombcollisions_fo_p</title>
<path fill="none" stroke="#000000" d="M270.0944,-420.0287C278.4219,-419.5466 287.0436,-419.0475 295.6743,-418.5478"/>
<polygon fill="#000000" stroke="#000000" points="296.0121,-422.0342 305.7931,-417.962 295.6075,-415.0459 296.0121,-422.0342"/>
</g>
<!-- proc~interp_fofields_p&#45;&gt;ezspline_error -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge11" class="edge">
<title>proc~interp_fofields_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M439.2959,-643.0535C493.5807,-647.3709 584.4276,-657.1842 660,-678 688.3656,-685.8131 719.0349,-698.9409 741.4868,-709.4945"/>
<polygon fill="#000000" stroke="#000000" points="740.0433,-712.6838 750.5752,-713.8369 743.0611,-706.3677 740.0433,-712.6838"/>
</g>
<!-- proc~interp_fofields_p&#45;&gt;ezspline_interp -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge12" class="edge">
<title>proc~interp_fofields_p&#45;&gt;ezspline_interp</title>
<path fill="none" stroke="#000000" d="M439.1153,-639.1625C492.8547,-638.6178 582.8461,-638.9131 660,-645 680.6175,-646.6266 703.1875,-649.5358 722.7981,-652.4317"/>
<polygon fill="#000000" stroke="#000000" points="722.3464,-655.9031 732.7574,-653.938 723.3932,-648.9818 722.3464,-655.9031"/>
</g>
<!-- proc~interp_fofields_p&#45;&gt;proc~check_if_in_fields_domain_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge13" class="edge">
<title>proc~interp_fofields_p&#45;&gt;proc~check_if_in_fields_domain_p</title>
<path fill="none" stroke="#000000" d="M431.4317,-652.0819C461.9275,-661.3088 504.1296,-674.0777 536.809,-683.9653"/>
<polygon fill="#000000" stroke="#000000" points="536.0366,-687.3882 546.6217,-686.9343 538.0638,-680.6882 536.0366,-687.3882"/>
</g>
<!-- proc~advance_fointerp_vars&#45;&gt;proc~include_coulombcollisions_fo_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge15" class="edge">
<title>proc~advance_fointerp_vars&#45;&gt;proc~include_coulombcollisions_fo_p</title>
<path fill="none" stroke="#000000" d="M264.2397,-392.2365C278.2037,-394.5148 293.223,-396.9653 307.876,-399.3561"/>
<polygon fill="#000000" stroke="#000000" points="307.5113,-402.8428 317.9444,-400.9988 308.6385,-395.9341 307.5113,-402.8428"/>
</g>
<!-- proc~radiation_force_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node11" class="node">
<title>proc~radiation_force_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node11"><a xlink:href=".././proc/radiation_force_p.html" xlink:title="radiation_force_p">
<polygon fill="#d9534f" stroke="#d9534f" points="438.5,-383 344.5,-383 344.5,-359 438.5,-359 438.5,-383"/>
<text text-anchor="middle" x="391.5" y="-368.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">radiation_force_p</text>
</a>
</g>
</g>
<!-- proc~advance_fointerp_vars&#45;&gt;proc~radiation_force_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge14" class="edge">
<title>proc~advance_fointerp_vars&#45;&gt;proc~radiation_force_p</title>
<path fill="none" stroke="#000000" d="M264.2397,-378.3677C286.8215,-377.0603 312.1629,-375.5932 334.2521,-374.3144"/>
<polygon fill="#000000" stroke="#000000" points="334.6975,-377.7945 344.4784,-373.7223 334.2928,-370.8062 334.6975,-377.7945"/>
</g>
<!-- proc~calculate_magnetic_field_p&#45;&gt;ezspline_error -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge17" class="edge">
<title>proc~calculate_magnetic_field_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M629.1601,-766.9735C657.6786,-758.9337 695.2917,-748.33 725.1088,-739.9241"/>
<polygon fill="#000000" stroke="#000000" points="726.2223,-743.2467 734.8974,-737.1646 724.3229,-736.5093 726.2223,-743.2467"/>
</g>
<!-- proc~calculate_magnetic_field_p&#45;&gt;ezspline_interp -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge18" class="edge">
<title>proc~calculate_magnetic_field_p&#45;&gt;ezspline_interp</title>
<path fill="none" stroke="#000000" d="M633.657,-766.9557C642.8966,-763.3512 652.1465,-758.7701 660,-753 681.4899,-737.2109 675.9358,-722.5653 696,-705 708.2253,-694.2973 723.4731,-685.0289 737.27,-677.7957"/>
<polygon fill="#000000" stroke="#000000" points="739.1839,-680.7503 746.5349,-673.1206 736.0304,-674.5009 739.1839,-680.7503"/>
</g>
<!-- ezspline_gradient -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node13" class="node">
<title>ezspline_gradient</title>
<polygon fill="#777777" stroke="#777777" points="822,-791 727,-791 727,-767 822,-767 822,-791"/>
<text text-anchor="middle" x="774.5" y="-776.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ezspline_gradient</text>
</g>
<!-- proc~calculate_magnetic_field_p&#45;&gt;ezspline_gradient -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge16" class="edge">
<title>proc~calculate_magnetic_field_p&#45;&gt;ezspline_gradient</title>
<path fill="none" stroke="#000000" d="M656.2371,-779C676.1672,-779 697.6593,-779 716.7843,-779"/>
<polygon fill="#000000" stroke="#000000" points="716.8437,-782.5001 726.8437,-779 716.8437,-775.5001 716.8437,-782.5001"/>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;cart_to_cyl_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge28" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;cart_to_cyl_p</title>
<path fill="none" stroke="#000000" d="M466.1503,-400.9692C470.1392,-398.467 473.8102,-395.5038 477,-392 550.498,-311.2656 441.0266,-231.0965 513,-149 519.7583,-141.2911 529.1306,-136.3225 538.9239,-133.1422"/>
<polygon fill="#000000" stroke="#000000" points="540.0114,-136.4748 548.7764,-130.5229 538.2128,-129.7098 540.0114,-136.4748"/>
</g>
<!-- proc~dca_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node14" class="node">
<title>proc~dca_sd</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node14"><a xlink:href=".././proc/dca_sd.html" xlink:title="dCA_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="613.5,-551 559.5,-551 559.5,-527 613.5,-527 613.5,-551"/>
<text text-anchor="middle" x="586.5" y="-536.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dCA_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~dca_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge19" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~dca_sd</title>
<path fill="none" stroke="#000000" d="M402.2711,-425.3166C422.0445,-447.1753 466.4,-492.8146 513,-518 524.219,-524.0634 537.3716,-528.5337 549.4255,-531.7526"/>
<polygon fill="#000000" stroke="#000000" points="548.6786,-535.1732 559.2258,-534.1696 550.3548,-528.3768 548.6786,-535.1732"/>
</g>
<!-- proc~analytical_profiles_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node15" class="node">
<title>proc~analytical_profiles_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node15"><a xlink:href=".././proc/analytical_profiles_p.html" xlink:title="analytical_profiles_p">
<polygon fill="#d9534f" stroke="#d9534f" points="640.5,-509 532.5,-509 532.5,-485 640.5,-485 640.5,-509"/>
<text text-anchor="middle" x="586.5" y="-494.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">analytical_profiles_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~analytical_profiles_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge20" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~analytical_profiles_p</title>
<path fill="none" stroke="#000000" d="M411.974,-425.2346C435.6561,-438.9993 476.1255,-461.3434 513,-476 518.1643,-478.0527 523.6056,-479.9957 529.0953,-481.81"/>
<polygon fill="#000000" stroke="#000000" points="528.3896,-485.2575 538.9794,-484.9327 530.4984,-478.5827 528.3896,-485.2575"/>
</g>
<!-- proc~interp_focollision_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node16" class="node">
<title>proc~interp_focollision_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node16"><a xlink:href=".././proc/interp_focollision_p.html" xlink:title="interp_FOcollision_p">
<polygon fill="#d9534f" stroke="#d9534f" points="640.5,-593 532.5,-593 532.5,-569 640.5,-569 640.5,-593"/>
<text text-anchor="middle" x="586.5" y="-578.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interp_FOcollision_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~interp_focollision_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge21" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~interp_focollision_p</title>
<path fill="none" stroke="#000000" d="M398.2023,-425.396C414.1667,-453.7269 457.3034,-523.5736 513,-560 516.1272,-562.0452 519.4556,-563.8946 522.9032,-565.5665"/>
<polygon fill="#000000" stroke="#000000" points="521.6818,-568.8512 532.2509,-569.59 524.4494,-562.4215 521.6818,-568.8512"/>
</g>
<!-- proc~unitvectors_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node17" class="node">
<title>proc~unitvectors_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node17"><a xlink:href=".././proc/unitvectors_p.html" xlink:title="unitVectors_p">
<polygon fill="#d9534f" stroke="#d9534f" points="625,-467 548,-467 548,-443 625,-443 625,-467"/>
<text text-anchor="middle" x="586.5" y="-452.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">unitVectors_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~unitvectors_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge22" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~unitvectors_p</title>
<path fill="none" stroke="#000000" d="M447.3792,-425.0355C476.046,-431.2099 510.6225,-438.6571 538.1333,-444.5826"/>
<polygon fill="#000000" stroke="#000000" points="537.4123,-448.0075 547.9251,-446.6916 538.8863,-441.1644 537.4123,-448.0075"/>
</g>
<!-- proc~cb_ei_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node18" class="node">
<title>proc~cb_ei_sd</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node18"><a xlink:href=".././proc/cb_ei_sd.html" xlink:title="CB_ei_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="617.5,-224 555.5,-224 555.5,-200 617.5,-200 617.5,-224"/>
<text text-anchor="middle" x="586.5" y="-209.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CB_ei_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~cb_ei_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge24" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~cb_ei_sd</title>
<path fill="none" stroke="#000000" d="M463.5205,-400.8064C468.3574,-398.3667 472.92,-395.4602 477,-392 507.9774,-365.7288 492.496,-343.0623 513,-308 529.4482,-279.8733 552.9729,-250.5602 568.945,-231.8407"/>
<polygon fill="#000000" stroke="#000000" points="571.8072,-233.8816 575.6995,-224.0276 566.5117,-229.3036 571.8072,-233.8816"/>
</g>
<!-- proc~ca_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node19" class="node">
<title>proc~ca_sd</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node19"><a xlink:href=".././proc/ca_sd.html" xlink:title="CA_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="613.5,-425 559.5,-425 559.5,-401 613.5,-401 613.5,-425"/>
<text text-anchor="middle" x="586.5" y="-410.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CA_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~ca_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge25" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~ca_sd</title>
<path fill="none" stroke="#000000" d="M477.0298,-413C502.3011,-413 528.6616,-413 549.1814,-413"/>
<polygon fill="#000000" stroke="#000000" points="549.3429,-416.5001 559.3428,-413 549.3428,-409.5001 549.3429,-416.5001"/>
</g>
<!-- proc~get_random -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node20" class="node">
<title>proc~get_random</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node20"><a xlink:href=".././proc/get_random.html" xlink:title="get_random">
<polygon fill="#d94e8f" stroke="#d94e8f" points="621,-182 552,-182 552,-158 621,-158 621,-182"/>
<text text-anchor="middle" x="586.5" y="-167.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">get_random</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~get_random -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge26" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~get_random</title>
<path fill="none" stroke="#000000" d="M466.0287,-400.8568C470.047,-398.3818 473.7578,-395.4554 477,-392 539.0999,-325.818 452.1503,-258.3332 513,-191 520.5619,-182.6324 531.2032,-177.506 542.0459,-174.3912"/>
<polygon fill="#000000" stroke="#000000" points="543.0416,-177.7527 551.9777,-172.0607 541.4425,-170.9378 543.0416,-177.7527"/>
</g>
<!-- proc~cb_ee_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node21" class="node">
<title>proc~cb_ee_sd</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node21"><a xlink:href=".././proc/cb_ee_sd.html" xlink:title="CB_ee_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="619,-383 554,-383 554,-359 619,-359 619,-383"/>
<text text-anchor="middle" x="586.5" y="-368.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CB_ee_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~cb_ee_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge27" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~cb_ee_sd</title>
<path fill="none" stroke="#000000" d="M447.3792,-400.9645C478.0507,-394.3583 515.4872,-386.2951 543.7967,-380.1976"/>
<polygon fill="#000000" stroke="#000000" points="544.7453,-383.5737 553.7841,-378.0465 543.2713,-376.7306 544.7453,-383.5737"/>
</g>
<!-- proc~cf_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node22" class="node">
<title>proc~cf_sd</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node22"><a xlink:href=".././proc/cf_sd.html" xlink:title="CF_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="613.5,-341 559.5,-341 559.5,-317 613.5,-317 613.5,-341"/>
<text text-anchor="middle" x="586.5" y="-326.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CF_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~cf_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge23" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~cf_sd</title>
<path fill="none" stroke="#000000" d="M458.5058,-400.8978C464.9869,-398.4568 471.2718,-395.5239 477,-392 497.9403,-379.1179 492.3046,-363.272 513,-350 523.9094,-343.0038 537.1912,-338.2894 549.448,-335.134"/>
<polygon fill="#000000" stroke="#000000" points="550.4693,-338.4904 559.4279,-332.8342 548.8974,-331.6692 550.4693,-338.4904"/>
</g>
<!-- proc~gammacee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node25" class="node">
<title>proc~gammacee</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node25"><a xlink:href=".././proc/gammacee.html" xlink:title="Gammacee">
<polygon fill="#d94e8f" stroke="#d94e8f" points="808,-382 741,-382 741,-358 808,-358 808,-382"/>
<text text-anchor="middle" x="774.5" y="-367.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Gammacee</text>
</a>
</g>
</g>
<!-- proc~dca_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge31" class="edge">
<title>proc~dca_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M613.562,-535.7409C628.3454,-532.9163 646.3637,-527.6779 660,-518 682.6257,-501.9422 679.2641,-489.1288 696,-467 716.6039,-439.7568 741.605,-409.2771 757.7715,-389.8815"/>
<polygon fill="#000000" stroke="#000000" points="760.5944,-391.9617 764.3252,-382.0455 755.2248,-387.4708 760.5944,-391.9617"/>
</g>
<!-- proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node28" class="node">
<title>proc~vte</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node28"><a xlink:href=".././proc/vte.html" xlink:title="VTe">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1033,-382 979,-382 979,-358 1033,-358 1033,-382"/>
<text text-anchor="middle" x="1006" y="-367.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VTe</text>
</a>
</g>
</g>
<!-- proc~dca_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge29" class="edge">
<title>proc~dca_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M613.9828,-545.7073C680.0916,-560.0554 849.436,-585.9171 943,-501 975.6439,-471.373 993.0717,-421.1832 1000.8497,-392.2877"/>
<polygon fill="#000000" stroke="#000000" points="1004.306,-392.8965 1003.3698,-382.3431 997.5205,-391.1769 1004.306,-392.8965"/>
</g>
<!-- proc~psi -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node29" class="node">
<title>proc~psi</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node29"><a xlink:href=".././proc/psi.html" xlink:title="psi">
<polygon fill="#d94e8f" stroke="#d94e8f" points="801.5,-500 747.5,-500 747.5,-476 801.5,-476 801.5,-500"/>
<text text-anchor="middle" x="774.5" y="-485.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">psi</text>
</a>
</g>
</g>
<!-- proc~dca_sd&#45;&gt;proc~psi -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge30" class="edge">
<title>proc~dca_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M613.8368,-531.5842C646.5103,-522.7206 701.3226,-507.8513 737.6981,-497.9835"/>
<polygon fill="#000000" stroke="#000000" points="738.7004,-501.3382 747.4352,-495.342 736.8676,-494.5823 738.7004,-501.3382"/>
</g>
<!-- proc~interp_focollision_p&#45;&gt;ezspline_error -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge32" class="edge">
<title>proc~interp_focollision_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M601.1782,-593.1643C616.2431,-605.7908 640.2126,-626.2773 660,-645 676.6659,-660.7692 677.8042,-668.0238 696,-682 709.4162,-692.305 725.5272,-701.7644 739.6531,-709.2499"/>
<polygon fill="#000000" stroke="#000000" points="738.11,-712.3922 748.6008,-713.873 741.3232,-706.1732 738.11,-712.3922"/>
</g>
<!-- proc~interp_focollision_p&#45;&gt;ezspline_interp -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge33" class="edge">
<title>proc~interp_focollision_p&#45;&gt;ezspline_interp</title>
<path fill="none" stroke="#000000" d="M624.3684,-593.0385C635.9626,-597.0847 648.6479,-601.882 660,-607 676.686,-614.5227 679.5823,-618.9085 696,-627 708.6328,-633.2261 722.6779,-639.5049 735.3555,-644.943"/>
<polygon fill="#000000" stroke="#000000" points="734.1648,-648.2397 744.7376,-648.9229 736.8985,-641.7956 734.1648,-648.2397"/>
</g>
<!-- proc~check_if_in_profiles_domain_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node26" class="node">
<title>proc~check_if_in_profiles_domain_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node26"><a xlink:href=".././proc/check_if_in_profiles_domain_p.html" xlink:title="check_if_in_profiles_domain_p">
<polygon fill="#d9534f" stroke="#d9534f" points="853,-618 696,-618 696,-594 853,-594 853,-618"/>
<text text-anchor="middle" x="774.5" y="-603.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">check_if_in_profiles_domain_p</text>
</a>
</g>
</g>
<!-- proc~interp_focollision_p&#45;&gt;proc~check_if_in_profiles_domain_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge34" class="edge">
<title>proc~interp_focollision_p&#45;&gt;proc~check_if_in_profiles_domain_p</title>
<path fill="none" stroke="#000000" d="M640.6252,-588.1975C654.7735,-590.0789 670.4012,-592.1571 685.8364,-594.2096"/>
<polygon fill="#000000" stroke="#000000" points="685.5601,-597.7036 695.9342,-595.5524 686.4829,-590.7647 685.5601,-597.7036"/>
</g>
<!-- proc~clogee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node23" class="node">
<title>proc~clogee</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node23"><a xlink:href=".././proc/clogee.html" xlink:title="CLogee">
<polygon fill="#d94e8f" stroke="#d94e8f" points="943,-262 889,-262 889,-238 943,-238 943,-262"/>
<text text-anchor="middle" x="916" y="-247.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CLogee</text>
</a>
</g>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~clogee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge35" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~clogee</title>
<path fill="none" stroke="#000000" d="M617.8407,-213.5112C667.816,-216.2149 768.5383,-222.8682 853,-236 861.422,-237.3094 870.4015,-239.0768 878.8637,-240.9144"/>
<polygon fill="#000000" stroke="#000000" points="878.3321,-244.3823 888.8568,-243.1646 879.8699,-237.5533 878.3321,-244.3823"/>
</g>
<!-- proc~clogei -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node24" class="node">
<title>proc~clogei</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node24"><a xlink:href=".././proc/clogei.html" xlink:title="CLogei">
<polygon fill="#d94e8f" stroke="#d94e8f" points="943,-146 889,-146 889,-122 943,-122 943,-146"/>
<text text-anchor="middle" x="916" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CLogei</text>
</a>
</g>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~clogei -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge36" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~clogei</title>
<path fill="none" stroke="#000000" d="M617.5463,-209.0841C631.8422,-206.3561 648.2081,-201.1016 660,-191 688.9961,-166.1604 663.8389,-133.5777 696,-113 752.5736,-76.8024 834.6424,-99.9263 880.8883,-118.17"/>
<polygon fill="#000000" stroke="#000000" points="879.6097,-121.4284 890.1909,-121.9659 882.2543,-114.9472 879.6097,-121.4284"/>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge37" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M599.3085,-224.2785C619.4131,-243.3892 659.8229,-281.1539 696,-311 713.4208,-325.3721 733.8318,-340.6683 749.4738,-352.0838"/>
<polygon fill="#000000" stroke="#000000" points="747.4742,-354.9572 757.6239,-357.9961 751.5846,-349.2911 747.4742,-354.9572"/>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge38" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M617.5236,-202.9661C684.5767,-185.4722 844.864,-154.8561 943,-229 981.4637,-258.0602 996.975,-315.8537 1002.8012,-347.684"/>
<polygon fill="#000000" stroke="#000000" points="999.3856,-348.4806 1004.4799,-357.7703 1006.2906,-347.3313 999.3856,-348.4806"/>
</g>
<!-- proc~g_j -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node32" class="node">
<title>proc~g_j</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node32"><a xlink:href=".././proc/g_j.html" xlink:title="g_j">
<polygon fill="#d94e8f" stroke="#d94e8f" points="801.5,-146 747.5,-146 747.5,-122 801.5,-122 801.5,-146"/>
<text text-anchor="middle" x="774.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">g_j</text>
</a>
</g>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~g_j -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge39" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~g_j</title>
<path fill="none" stroke="#000000" d="M617.6868,-206.2387C631.2141,-202.957 646.9177,-198.0555 660,-191 678.5842,-180.9772 677.628,-170.4066 696,-160 708.7416,-152.7827 723.7918,-147.1891 737.2882,-143.0711"/>
<polygon fill="#000000" stroke="#000000" points="738.5997,-146.3359 747.2421,-140.2073 736.6642,-139.6088 738.5997,-146.3359"/>
</g>
<!-- proc~ca_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge42" class="edge">
<title>proc~ca_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M613.8368,-406.7474C644.5555,-399.7214 694.8431,-388.2194 730.9798,-379.9541"/>
<polygon fill="#000000" stroke="#000000" points="731.8011,-383.3567 740.769,-377.7151 730.2403,-376.5329 731.8011,-383.3567"/>
</g>
<!-- proc~ca_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge40" class="edge">
<title>proc~ca_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M613.5122,-415.2849C628.6413,-417.7965 647.0163,-423.0465 660,-434 688.2609,-457.8419 664.7054,-489.3084 696,-509 755.0588,-546.1618 784.6098,-522.8461 853,-509 895.5559,-500.3842 909.968,-499.1802 943,-471 968.6322,-449.1327 987.1678,-414.1552 997.2501,-391.6344"/>
<polygon fill="#000000" stroke="#000000" points="1000.548,-392.8247 1001.2827,-382.2553 994.1173,-390.0596 1000.548,-392.8247"/>
</g>
<!-- proc~ca_sd&#45;&gt;proc~psi -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge41" class="edge">
<title>proc~ca_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M613.6158,-418.1327C627.9081,-421.4757 645.4442,-426.6122 660,-434 678.0749,-443.174 678.1195,-452.4526 696,-462 708.9176,-468.8974 724.0035,-474.426 737.4792,-478.5816"/>
<polygon fill="#000000" stroke="#000000" points="736.8269,-482.0376 747.4077,-481.4917 738.7959,-475.3202 736.8269,-482.0376"/>
</g>
<!-- interface~random_get_number_u -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node27" class="node">
<title>interface~random_get_number_u</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node27"><a xlink:href=".././interface/random_get_number_u.html" xlink:title="random_get_number_U">
<polygon fill="#a7506f" stroke="#a7506f" points="836,-66 713,-66 713,-42 836,-42 836,-66"/>
<text text-anchor="middle" x="774.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">random_get_number_U</text>
</a>
</g>
</g>
<!-- proc~get_random&#45;&gt;interface~random_get_number_u -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge44" class="edge">
<title>proc~get_random&#45;&gt;interface~random_get_number_u</title>
<path fill="none" stroke="#000000" d="M621.0288,-166.0594C634.3494,-163.1151 648.9952,-157.9741 660,-149 686.8065,-127.1401 669.6533,-102.4119 696,-80 700.3058,-76.3373 705.1441,-73.1862 710.2493,-70.476"/>
<polygon fill="#000000" stroke="#000000" points="712.1015,-73.4732 719.6695,-66.0585 709.1295,-67.1354 712.1015,-73.4732"/>
</g>
<!-- omp_get_thread_num -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node31" class="node">
<title>omp_get_thread_num</title>
<polygon fill="#777777" stroke="#777777" points="832,-24 717,-24 717,0 832,0 832,-24"/>
<text text-anchor="middle" x="774.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">omp_get_thread_num</text>
</g>
<!-- proc~get_random&#45;&gt;omp_get_thread_num -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge43" class="edge">
<title>proc~get_random&#45;&gt;omp_get_thread_num</title>
<path fill="none" stroke="#000000" d="M621.1408,-167.1821C634.7962,-164.4204 649.6564,-159.1123 660,-149 698.5998,-111.2636 657.0826,-70.4088 696,-33 699.5026,-29.6332 703.4834,-26.7922 707.7503,-24.3964"/>
<polygon fill="#000000" stroke="#000000" points="709.3154,-27.5279 716.8491,-20.0784 706.3142,-21.2039 709.3154,-27.5279"/>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge48" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M619.2471,-370.8258C650.1369,-370.6615 696.6576,-370.4141 730.7217,-370.2329"/>
<polygon fill="#000000" stroke="#000000" points="730.881,-373.7322 740.8623,-370.1789 730.8437,-366.7323 730.881,-373.7322"/>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge45" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M619.3496,-378.6033C640.9876,-383.2135 670.0177,-388.6467 696,-391 765.4933,-397.2944 783.3844,-395.7552 853,-391 892.7738,-388.2832 937.9601,-381.6378 968.8535,-376.5441"/>
<polygon fill="#000000" stroke="#000000" points="969.4705,-379.9896 978.754,-374.884 968.3129,-373.0859 969.4705,-379.9896"/>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~psi -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge46" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M619.1969,-374.51C633.0038,-377.3748 648.5086,-382.5727 660,-392 687.0472,-414.1889 669.4194,-439.2542 696,-462 707.5862,-471.9147 723.0721,-478.0779 737.2269,-481.8959"/>
<polygon fill="#000000" stroke="#000000" points="736.6844,-485.3646 747.2237,-484.2815 738.3093,-478.5558 736.6844,-485.3646"/>
</g>
<!-- proc~delta -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node33" class="node">
<title>proc~delta</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node33"><a xlink:href=".././proc/delta.html" xlink:title="delta">
<polygon fill="#d94e8f" stroke="#d94e8f" points="943,-462 889,-462 889,-438 943,-438 943,-462"/>
<text text-anchor="middle" x="916" y="-447.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">delta</text>
</a>
</g>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~delta -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge47" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~delta</title>
<path fill="none" stroke="#000000" d="M619.1983,-377.0198C632.3948,-380.2814 647.4389,-385.0975 660,-392 678.7612,-402.3096 676.472,-415.2292 696,-424 755.7634,-450.8422 833.4012,-453.4744 878.6648,-452.2307"/>
<polygon fill="#000000" stroke="#000000" points="879.0314,-455.72 888.9009,-451.8674 878.783,-448.7244 879.0314,-455.72"/>
</g>
<!-- proc~cf_sd&#45;&gt;proc~clogee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge49" class="edge">
<title>proc~cf_sd&#45;&gt;proc~clogee</title>
<path fill="none" stroke="#000000" d="M603.3277,-316.8477C624.0136,-302.6267 660.7268,-279.6685 696,-269 758.1678,-250.1971 834.4039,-247.96 878.8605,-248.5975"/>
<polygon fill="#000000" stroke="#000000" points="878.848,-252.0979 888.9162,-248.7992 878.9885,-245.0993 878.848,-252.0979"/>
</g>
<!-- proc~cf_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge50" class="edge">
<title>proc~cf_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M613.8368,-334.9618C644.5555,-341.661 694.8431,-352.628 730.9798,-360.5089"/>
<polygon fill="#000000" stroke="#000000" points="730.2528,-363.9325 740.769,-362.6438 731.7444,-357.0933 730.2528,-363.9325"/>
</g>
<!-- proc~cf_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge52" class="edge">
<title>proc~cf_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M613.7889,-330.4924C662.0968,-333.2582 765.7978,-339.7523 853,-349 892.7639,-353.2169 938.1247,-359.6479 969.0652,-364.2819"/>
<polygon fill="#000000" stroke="#000000" points="968.5657,-367.7461 978.9763,-365.7788 969.6111,-360.8246 968.5657,-367.7461"/>
</g>
<!-- proc~cf_sd&#45;&gt;proc~psi -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge53" class="edge">
<title>proc~cf_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M613.6288,-332.7465C628.2589,-335.714 646.1082,-340.9332 660,-350 666.2751,-354.0956 727.8942,-430.1103 758.0476,-467.5321"/>
<polygon fill="#000000" stroke="#000000" points="755.651,-470.1366 764.6482,-475.7312 761.1036,-465.7469 755.651,-470.1366"/>
</g>
<!-- proc~h_j -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node30" class="node">
<title>proc~h_j</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node30"><a xlink:href=".././proc/h_j.html" xlink:title="h_j">
<polygon fill="#d94e8f" stroke="#d94e8f" points="801.5,-302 747.5,-302 747.5,-278 801.5,-278 801.5,-302"/>
<text text-anchor="middle" x="774.5" y="-287.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h_j</text>
</a>
</g>
</g>
<!-- proc~cf_sd&#45;&gt;proc~h_j -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge51" class="edge">
<title>proc~cf_sd&#45;&gt;proc~h_j</title>
<path fill="none" stroke="#000000" d="M613.8368,-323.3291C646.3707,-316.58 700.8545,-305.2775 737.2307,-297.7314"/>
<polygon fill="#000000" stroke="#000000" points="738.3546,-301.0728 747.4352,-295.6145 736.9327,-294.2188 738.3546,-301.0728"/>
</g>
<!-- proc~clogee&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge55" class="edge">
<title>proc~clogee&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M925.2926,-262.3901C940.8002,-283.0669 972.0975,-324.7967 990.8347,-349.7796"/>
<polygon fill="#000000" stroke="#000000" points="988.0919,-351.956 996.892,-357.856 993.692,-347.756 988.0919,-351.956"/>
</g>
<!-- proc~clog0 -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node34" class="node">
<title>proc~clog0</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node34"><a xlink:href=".././proc/clog0.html" xlink:title="CLog0">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1033,-204 979,-204 979,-180 1033,-180 1033,-204"/>
<text text-anchor="middle" x="1006" y="-189.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CLog0</text>
</a>
</g>
</g>
<!-- proc~clogee&#45;&gt;proc~clog0 -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge54" class="edge">
<title>proc~clogee&#45;&gt;proc~clog0</title>
<path fill="none" stroke="#000000" d="M934.6481,-237.9824C947.4395,-229.739 964.617,-218.6691 978.9124,-209.4565"/>
<polygon fill="#000000" stroke="#000000" points="980.8661,-212.3613 987.3758,-204.0022 977.0741,-206.4773 980.8661,-212.3613"/>
</g>
<!-- proc~clogei&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge57" class="edge">
<title>proc~clogei&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M931.2058,-146.0475C935.5175,-150.094 939.8816,-154.8893 943,-160 980.694,-221.7767 997.1479,-307.6224 1003.1199,-347.7122"/>
<polygon fill="#000000" stroke="#000000" points="999.673,-348.335 1004.5353,-357.7482 1006.6044,-347.3574 999.673,-348.335"/>
</g>
<!-- proc~clogei&#45;&gt;proc~clog0 -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge56" class="edge">
<title>proc~clogei&#45;&gt;proc~clog0</title>
<path fill="none" stroke="#000000" d="M934.6481,-146.0176C947.4395,-154.261 964.617,-165.3309 978.9124,-174.5435"/>
<polygon fill="#000000" stroke="#000000" points="977.0741,-177.5227 987.3758,-179.9978 980.8661,-171.6387 977.0741,-177.5227"/>
</g>
<!-- proc~gammacee&#45;&gt;proc~clogee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge58" class="edge">
<title>proc~gammacee&#45;&gt;proc~clogee</title>
<path fill="none" stroke="#000000" d="M791.8192,-357.9324C808.0508,-346.4037 832.777,-328.2734 853,-311 868.5304,-297.7348 885.0849,-281.6206 897.3251,-269.2864"/>
<polygon fill="#000000" stroke="#000000" points="899.8233,-271.7377 904.3411,-262.1543 894.8331,-266.8287 899.8233,-271.7377"/>
</g>
<!-- proc~delta&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge59" class="edge">
<title>proc~delta&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M929.6691,-437.8497C944.2907,-424.8527 967.6735,-404.068 984.7099,-388.9246"/>
<polygon fill="#000000" stroke="#000000" points="987.3484,-391.2621 992.4972,-382.0025 982.6978,-386.0302 987.3484,-391.2621"/>
</g>
</g>
</svg>
</div><script>var panprocadv_fointerp_topCallsGraph = svgPanZoom('#procadv_fointerp_topCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="554pt" height="32pt"
 viewBox="0.00 0.00 553.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 549.5,-28 549.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="63,-24 0,-24 0,0 63,0 63,-24"/>
<text text-anchor="middle" x="31.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="135.5,-24 81.5,-24 81.5,0 135.5,0 135.5,-24"/>
<text text-anchor="middle" x="108.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="207.5,-24 153.5,-24 153.5,0 207.5,0 207.5,-24"/>
<text text-anchor="middle" x="180.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="359.5,-24 225.5,-24 225.5,0 359.5,0 359.5,-24"/>
<text text-anchor="middle" x="292.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="431.5,-24 377.5,-24 377.5,0 431.5,0 431.5,-24"/>
<text text-anchor="middle" x="404.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="545.5,-24 449.5,-24 449.5,0 545.5,0 545.5,-24"/>
<text text-anchor="middle" x="497.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~adv_fointerp_top~~CalledByGraph Pages: 1 -->
<svg id="procadv_fointerp_topCalledByGraph" width="195pt" height="32pt"
 viewBox="0.00 0.00 195.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~adv_fointerp_top~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~adv_fointerp_top~~CalledByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 191,-28 191,4 -4,4"/>
<!-- proc~adv_fointerp_top -->
<g id="proc~~adv_fointerp_top~~CalledByGraph_node1" class="node">
<title>proc~adv_fointerp_top</title>
<polygon fill="none" stroke="#000000" points="187,-24 90,-24 90,0 187,0 187,-24"/>
<text text-anchor="middle" x="138.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">adv_FOinterp_top</text>
</g>
<!-- program~main -->
<g id="proc~~adv_fointerp_top~~CalledByGraph_node2" class="node">
<title>program~main</title>
<g id="a_proc~~adv_fointerp_top~~CalledByGraph_node2"><a xlink:href=".././program/main.html" xlink:title="main">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main</text>
</a>
</g>
</g>
<!-- program~main&#45;&gt;proc~adv_fointerp_top -->
<g id="proc~~adv_fointerp_top~~CalledByGraph_edge1" class="edge">
<title>program~main&#45;&gt;proc~adv_fointerp_top</title>
<path fill="none" stroke="#000000" d="M54.276,-12C62.0518,-12 70.8379,-12 79.7268,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.758,-15.5001 89.7579,-12 79.7579,-8.5001 79.758,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="554pt" height="32pt"
 viewBox="0.00 0.00 553.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 549.5,-28 549.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="63,-24 0,-24 0,0 63,0 63,-24"/>
<text text-anchor="middle" x="31.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="135.5,-24 81.5,-24 81.5,0 135.5,0 135.5,-24"/>
<text text-anchor="middle" x="108.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="207.5,-24 153.5,-24 153.5,0 207.5,0 207.5,-24"/>
<text text-anchor="middle" x="180.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="359.5,-24 225.5,-24 225.5,0 359.5,0 359.5,-24"/>
<text text-anchor="middle" x="292.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="431.5,-24 377.5,-24 377.5,0 431.5,0 431.5,-24"/>
<text text-anchor="middle" x="404.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="545.5,-24 449.5,-24 449.5,0 545.5,0 545.5,-24"/>
<text text-anchor="middle" x="497.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/adv_fointerp_top.html#src">adv_FOinterp_top</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">adv_FOinterp_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">spp</span><span class="p">)</span>  
    <span class="k">TYPE</span><span class="p">(</span><span class="n">KORC_PARAMS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>                           <span class="kd">::</span> <span class="n">params</span>
    <span class="c">!! Core KORC simulation parameters.</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">FIELDS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                                   <span class="kd">::</span> <span class="n">F</span>
    <span class="c">!! An instance of the KORC derived type FIELDS.</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">PROFILES</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                                 <span class="kd">::</span> <span class="n">P</span>
    <span class="c">!! An instance of the KORC derived type PROFILES.</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">SPECIES</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">spp</span>
    <span class="c">!! An instance of the derived type SPECIES containing all the parameters</span>
    <span class="c">!! and simulation variables of the different species in the simulation.</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">Bmag</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">b_unit_X</span><span class="p">,</span><span class="n">b_unit_Y</span><span class="p">,</span><span class="n">b_unit_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">v</span><span class="p">,</span><span class="n">vpar</span><span class="p">,</span><span class="n">vperp</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">tmp</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">g</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">cross_X</span><span class="p">,</span><span class="n">cross_Y</span><span class="p">,</span><span class="n">cross_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">vec_X</span><span class="p">,</span><span class="n">vec_Y</span><span class="p">,</span><span class="n">vec_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X_X</span><span class="p">,</span><span class="n">X_Y</span><span class="p">,</span><span class="n">X_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">V_X</span><span class="p">,</span><span class="n">V_Y</span><span class="p">,</span><span class="n">V_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B_X</span><span class="p">,</span><span class="n">B_Y</span><span class="p">,</span><span class="n">B_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">E_X</span><span class="p">,</span><span class="n">E_Y</span><span class="p">,</span><span class="n">E_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PSIp</span>
    <span class="kt">INTEGER</span><span class="p">(</span><span class="k">is</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flagCon</span><span class="p">,</span><span class="n">flagCol</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span><span class="p">,</span><span class="n">m_cache</span><span class="p">,</span><span class="n">q_cache</span>    
    <span class="kt">INTEGER</span>                                                    <span class="kd">::</span> <span class="n">ii</span>
    <span class="c">!! Species iterator.</span>
    <span class="kt">INTEGER</span>                                                    <span class="kd">::</span> <span class="n">pp</span><span class="p">,</span><span class="n">pchunk</span>
    <span class="c">!! Particles iterator.</span>
    <span class="kt">INTEGER</span>                                                    <span class="kd">::</span> <span class="n">cc</span>
    <span class="c">!! Chunk iterator.</span>
    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>                                                    <span class="kd">::</span> <span class="n">tt</span>
    <span class="c">!! time iterator.     </span>

    <span class="k">do </span><span class="n">ii</span> <span class="o">=</span> <span class="mi">1_idef</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">num_species</span>      

       <span class="n">pchunk</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span>
       <span class="n">m_cache</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">m</span>
       <span class="n">q_cache</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">q</span>
       <span class="n">a</span> <span class="o">=</span> <span class="n">q_cache</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span><span class="o">/</span><span class="n">m_cache</span>


       <span class="c">!$OMP PARALLEL DO default(none) &amp;</span>
       <span class="c">!$OMP&amp; FIRSTPRIVATE(a,m_cache,q_cache,pchunk) &amp;</span>
       <span class="c">!$OMP&amp; shared(params,ii,spp,P,F) &amp;</span>
       <span class="c">!$OMP&amp; PRIVATE(E0,pp,tt,Bmag,cc,X_X,X_Y,X_Z,V_X,V_Y,V_Z,B_X,B_Y,B_Z, &amp;</span>
       <span class="c">!$OMP&amp; E_X,E_Y,E_Z,b_unit_X,b_unit_Y,b_unit_Z,v,vpar,vperp,tmp, &amp;</span>
       <span class="c">!$OMP&amp; cross_X,cross_Y,cross_Z,vec_X,vec_Y,vec_Z,g, &amp;</span>
       <span class="c">!$OMP&amp; Y_R,Y_PHI,Y_Z,flagCon,flagCol,PSIp)</span>
       <span class="k">do </span><span class="n">pp</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">ppp</span><span class="p">,</span><span class="n">pchunk</span>

          <span class="c">!$OMP SIMD</span>
          <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>
             <span class="n">X_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
             <span class="n">X_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
             <span class="n">X_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

             <span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
             <span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
             <span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

             <span class="n">PSIp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">PSI_P</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">g</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">flagCon</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCon</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">flagCol</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCol</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">end do</span>
          <span class="c">!$OMP END SIMD</span>

          <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">FokPlan</span><span class="p">)</span> <span class="k">then</span>
<span class="k">             do </span><span class="n">tt</span><span class="o">=</span><span class="mi">1_ip</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>

                <span class="k">call </span><span class="n">cart_to_cyl_p</span><span class="p">(</span><span class="n">pchunk</span><span class="p">,</span><span class="n">X_X</span><span class="p">,</span><span class="n">X_Y</span><span class="p">,</span><span class="n">X_Z</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;new&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                   call </span><span class="n">interp_FOfields_p</span><span class="p">(</span><span class="n">pchunk</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span><span class="n">B_X</span><span class="p">,</span><span class="n">B_Y</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">E_X</span><span class="p">,</span><span class="n">E_Y</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">PSIp</span><span class="p">,</span><span class="n">flagCon</span><span class="p">)</span>
                <span class="k">else if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;old&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                   call </span><span class="n">interp_FOfields1_p</span><span class="p">(</span><span class="n">pchunk</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span><span class="n">B_X</span><span class="p">,</span><span class="n">B_Y</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">E_X</span><span class="p">,</span><span class="n">E_Y</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">PSIp</span><span class="p">,</span><span class="n">flagCon</span><span class="p">)</span>
                <span class="k">end if</span>


                <span class="c">!               write(output_unit_write,&#39;(&quot;B_X: &quot;,E17.10)&#39;) B_X(1)</span>
                <span class="c">!               write(output_unit_write,&#39;(&quot;B_Y: &quot;,E17.10)&#39;) B_Y(1)</span>
                <span class="c">!               write(output_unit_write,&#39;(&quot;B_Z: &quot;,E17.10)&#39;) B_Z(1)</span>

                <span class="k">call </span><span class="n">advance_FOinterp_vars</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">q_cache</span><span class="p">,</span><span class="n">m_cache</span><span class="p">,</span><span class="n">params</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">X_X</span><span class="p">,</span><span class="n">X_Y</span><span class="p">,</span><span class="n">X_Z</span><span class="p">,</span><span class="n">V_X</span><span class="p">,</span><span class="n">V_Y</span><span class="p">,</span><span class="n">V_Z</span><span class="p">,</span><span class="n">B_X</span><span class="p">,</span><span class="n">B_Y</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span><span class="n">E_X</span><span class="p">,</span><span class="n">E_Y</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">g</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">flagCol</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">PSIp</span><span class="p">)</span>
             <span class="k">end do</span> <span class="c">!timestep iterator</span>

             <span class="c">!$OMP SIMD</span>
             <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">X_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">X_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">X_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">g</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCon</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">flagCon</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCol</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">flagCol</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">PSI_P</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">PSIp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="k">end do</span>
             <span class="c">!$OMP END SIMD</span>

          <span class="k">else</span>
             <span class="c">!$OMP SIMD</span>
             <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>
                <span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

                <span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
             <span class="k">end do</span>
             <span class="c">!$OMP END SIMD</span>

             <span class="k">call </span><span class="n">advance_FP3Dinterp_vars</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">X_X</span><span class="p">,</span><span class="n">X_Y</span><span class="p">,</span><span class="n">X_Z</span><span class="p">,</span><span class="n">V_X</span><span class="p">,</span><span class="n">V_Y</span><span class="p">,</span><span class="n">V_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">g</span><span class="p">,</span><span class="n">m_cache</span><span class="p">,</span><span class="n">B_X</span><span class="p">,</span><span class="n">B_Y</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span><span class="n">E_X</span><span class="p">,</span><span class="n">E_Y</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">flagCol</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">PSIp</span><span class="p">)</span>

             <span class="c">!$OMP SIMD</span>
             <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">g</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCol</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">flagCol</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

             <span class="k">end do</span>
             <span class="c">!$OMP END SIMD</span>
          <span class="k">end if</span>

          <span class="c">!$OMP SIMD</span>
          <span class="c">!          !$OMP&amp; aligned(Bmag,B_X,B_Y,B_Z, &amp;</span>
          <span class="c">!          !$OMP&amp; b_unit_X,b_unit_Y,b_unit_Z,v,V_X,V_Y,V_Z,vpar, &amp;</span>
          <span class="c">!          !$OMP&amp; vperp,tmp,cross_X,cross_Y,cross_Z, &amp;</span>
          <span class="c">!          !$OMP&amp; vec_X,vec_Y,vec_Z,E_X,E_Y,E_Z)</span>
          <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>
             <span class="c">!Derived output data</span>
             <span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>

             <span class="c">! Parallel unit vector</span>
             <span class="n">b_unit_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">b_unit_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">b_unit_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
             <span class="k">if</span> <span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">).</span><span class="n">GT</span><span class="p">.</span><span class="n">korc_zero</span><span class="p">)</span> <span class="k">then</span>
                <span class="c">! Parallel and perpendicular components of velocity</span>
                <span class="n">vpar</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">b_unit_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">b_unit_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">b_unit_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>

                <span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span>  <span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">vpar</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
                <span class="k">if</span> <span class="p">(</span> <span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">korc_zero</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                   </span><span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span> <span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="p">)</span>
                <span class="k">else</span>
<span class="k">                   </span><span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
                <span class="k">end if</span>

                <span class="c">! Pitch angle</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">eta</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mi">18</span><span class="mf">0.0_rp</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="nb">MODULO</span><span class="p">(</span><span class="n">ATAN2</span><span class="p">(</span><span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">vpar</span><span class="p">(</span><span class="n">cc</span><span class="p">)),</span><span class="mf">2.0_rp</span><span class="o">*</span><span class="n">C_PI</span><span class="p">)</span><span class="o">/</span><span class="n">C_PI</span>

                <span class="c">! Magnetic moment</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">mu</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5_rp</span><span class="o">*</span><span class="n">m_cache</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="c">! See Northrop&#39;s book (The adiabatic motion of charged</span>
                <span class="c">! particles)</span>

                <span class="c">! Radiated power</span>
                <span class="n">tmp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">q_cache</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="mf">6.0_rp</span><span class="o">*</span><span class="n">C_PI</span><span class="o">*</span><span class="n">E0</span><span class="o">*</span><span class="n">m_cache</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

                <span class="n">cross_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">-</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">cross_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">-</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">cross_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">-</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">vec_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="n">cross_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">vec_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="n">cross_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">vec_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="n">cross_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Prad</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="p">(</span> <span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">cross_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">cross_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">cross_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="p">((</span><span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="p">&amp;</span>
                     <span class="o">-</span> <span class="n">vec_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">vec_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">vec_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">vec_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">vec_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">vec_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span> <span class="p">)</span>

                <span class="c">! Input power due to electric field</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Pin</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">q_cache</span><span class="o">*</span><span class="p">(</span><span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
             <span class="k">else</span>
<span class="k">                </span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">eta</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">mu</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Prad</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Pin</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
             <span class="k">end if</span>

<span class="k">          end do</span>
          <span class="c">!$OMP END SIMD</span>


       <span class="k">end do</span> <span class="c">!particle chunk iterator</span>
       <span class="c">!$OMP END PARALLEL DO</span>

    <span class="k">end do</span> <span class="c">!species iterator</span>

  <span class="k">end subroutine </span><span class="n">adv_FOinterp_top</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> KORC was developed by Matt Beidler</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>