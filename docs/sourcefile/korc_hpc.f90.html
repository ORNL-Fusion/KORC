<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Kinetic Orbit Runaway electrons Code (KORC)">
    
    <meta name="author" content="Matt Beidler" >
    <link rel="icon" href="../favicon.png">

    <title>korc_hpc.f90 &ndash; KORC</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">KORC </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>README</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>korc_hpc.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.9% of total for source files.">190 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/korc_hpc.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">korc_hpc.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/korc_hpc.html">korc_hpc</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/korc_hpc.f90.html#src">korc_hpc.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~korc_hpc.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilekorc_hpcf90EfferentGraph" width="198pt" height="32pt"
 viewBox="0.00 0.00 198.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~korc_hpc.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~korc_hpc.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 194,-28 194,4 -4,4"/>
<!-- sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~korc_hpc.f90</title>
<polygon fill="none" stroke="#000000" points="190,-24 117,-24 117,0 190,0 190,-24"/>
<text text-anchor="middle" x="153.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">korc_hpc.f90</text>
</g>
<!-- sourcefile~korc_types.f90 -->
<g id="sourcefile~~korc_hpc.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~korc_types.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/korc_types.f90.html" xlink:title="korc_types.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="81,-24 0,-24 0,0 81,0 81,-24"/>
<text text-anchor="middle" x="40.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_types.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_hpc.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~korc_hpc.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~korc_hpc.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M116.8121,-12C108.7486,-12 100.0686,-12 91.5551,-12"/>
<polygon fill="#000000" stroke="#000000" points="91.3056,-8.5001 81.3056,-12 91.3055,-15.5001 91.3056,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~korc_hpc.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilekorc_hpcf90AfferentGraph" width="641pt" height="361pt"
 viewBox="0.00 0.00 641.00 360.90" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph" class="graph" transform="scale(.5079 .5079) rotate(0) translate(4 706.5423)">
<title>sourcefile~~korc_hpc.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-706.5423 1258,-706.5423 1258,4 -4,4"/>
<!-- sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~korc_hpc.f90</title>
<polygon fill="none" stroke="#000000" points="73,-394.0036 0,-394.0036 0,-370.0036 73,-370.0036 73,-394.0036"/>
<text text-anchor="middle" x="36.5" y="-379.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">korc_hpc.f90</text>
</g>
<!-- sourcefile~korc_experimental_pdf.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~korc_experimental_pdf.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/korc_experimental_pdf.f90.html" xlink:title="korc_experimental_pdf.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="852,-510.0036 716,-510.0036 716,-486.0036 852,-486.0036 852,-510.0036"/>
<text text-anchor="middle" x="784" y="-495.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_experimental_pdf.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M292.5,-536.0036C276.1995,-539.2981 162.8394,-582.5103 148,-575.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M598.5,-458.0036C458.4418,-448.977 430.0673,-508.2005 292.5,-536.0036"/>
</g>
<!-- sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~korc_fields.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/korc_fields.f90.html" xlink:title="korc_fields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="638.5,-354.0036 558.5,-354.0036 558.5,-330.0036 638.5,-330.0036 638.5,-354.0036"/>
<text text-anchor="middle" x="598.5" y="-339.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_fields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M743.2444,-485.9952C733.8671,-482.2818 724.2379,-477.6459 716,-472.0036 671.3828,-441.4446 632.0739,-390.6433 612.2141,-362.4459"/>
<polygon fill="#000000" stroke="#000000" points="615.0353,-360.372 606.4675,-354.1395 609.2787,-364.3546 615.0353,-360.372"/>
</g>
<!-- sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~korc_hdf5.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/korc_hdf5.f90.html" xlink:title="korc_HDF5.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="481,-548.0036 398,-548.0036 398,-524.0036 481,-524.0036 481,-548.0036"/>
<text text-anchor="middle" x="439.5" y="-533.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_HDF5.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M598.5,-458.0036C560.8181,-455.5751 550.602,-464.7777 517,-482.0036 498.9623,-491.2506 497.6099,-498.3857 481,-510.0036 476.9461,-512.8392 472.5911,-515.7289 468.2812,-518.5018"/>
<polygon fill="#000000" stroke="#000000" points="466.198,-515.6777 459.609,-523.9744 469.9338,-521.5975 466.198,-515.6777"/>
</g>
<!-- sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~korc_input.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/korc_input.f90.html" xlink:title="korc_input.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="187,-394.0036 109,-394.0036 109,-370.0036 187,-370.0036 187,-394.0036"/>
<text text-anchor="middle" x="148" y="-379.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_input.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M598.5,-458.0036C520.3377,-452.9662 517.6557,-376.8647 439.5,-382.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M744.6759,-485.9746C707.4519,-475.4395 649.7879,-461.3091 598.5,-458.0036"/>
</g>
<!-- sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558.4131,-330.1727C499.9603,-314.4188 387.9024,-289.8721 292.5,-302.0036"/>
</g>
<!-- sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M588.5538,-354.1392C561.8958,-386.6654 488.6479,-476.0371 455.8059,-516.1084"/>
<polygon fill="#000000" stroke="#000000" points="453.0743,-513.9198 449.4424,-523.8727 458.4883,-518.357 453.0743,-513.9198"/>
</g>
<!-- sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M558.1437,-353.9244C519.0042,-365.1627 462.2934,-380.5049 439.5,-382.0036"/>
</g>
<!-- sourcefile~korc_interp.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~korc_interp.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node16"><a xlink:href=".././sourcefile/korc_interp.f90.html" xlink:title="korc_interp.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.5,-198.0036 398.5,-198.0036 398.5,-174.0036 480.5,-174.0036 480.5,-198.0036"/>
<text text-anchor="middle" x="439.5" y="-183.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_interp.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_interp.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_interp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M578.9297,-329.9934C561.675,-318.9195 536.3414,-301.4474 517,-283.0036 491.9968,-259.161 467.9226,-227.1501 453.4153,-206.5455"/>
<polygon fill="#000000" stroke="#000000" points="456.2082,-204.431 447.6314,-198.211 450.4573,-208.422 456.2082,-204.431"/>
</g>
<!-- sourcefile~korc_finalize.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~korc_finalize.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/korc_finalize.f90.html" xlink:title="korc_finalize.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="828,-44.0036 740,-44.0036 740,-20.0036 828,-20.0036 828,-44.0036"/>
<text text-anchor="middle" x="784" y="-29.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_finalize.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M598.5,-108.0036C562.1781,-107.3186 474.5089,-60.3015 439.5,-70.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M747.2241,-44.0685C736.8787,-47.9924 725.7855,-52.7168 716,-58.0036 698.6357,-67.3851 697.7205,-75.3136 680,-84.0036 646.0971,-100.6295 636.2534,-108.7157 598.5,-108.0036"/>
</g>
<!-- sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M777.4125,-44.1049C764.5372,-68.0518 735.5844,-123.3788 716,-172.0036 696.6239,-220.1113 710.509,-241.0635 680,-283.0036 667.4284,-300.2855 648.2588,-314.5244 631.6689,-324.6818"/>
<polygon fill="#000000" stroke="#000000" points="629.6307,-321.8196 622.776,-329.8982 633.1725,-327.8575 629.6307,-321.8196"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~korc_spatial_distribution.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/korc_spatial_distribution.f90.html" xlink:title="korc_spatial_distribution.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1033,-510.0036 890,-510.0036 890,-486.0036 1033,-486.0036 1033,-510.0036"/>
<text text-anchor="middle" x="961.5" y="-495.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_spatial_distribution.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M148,-575.0036C80.8403,-540.9728 51.3605,-447.189 41.0789,-404.1352"/>
<polygon fill="#000000" stroke="#000000" points="44.4339,-403.1021 38.8181,-394.118 37.6056,-404.6432 44.4339,-403.1021"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M784,-420.0036C663.3537,-381.2735 336.4014,-465.4734 223,-522.0036 186.4708,-540.2133 184.4089,-593.4526 148,-575.0036"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_experimental_pdf.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_experimental_pdf.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M889.8156,-498.0036C880.7976,-498.0036 871.5352,-498.0036 862.4203,-498.0036"/>
<polygon fill="#000000" stroke="#000000" points="862.2127,-494.5037 852.2126,-498.0036 862.2126,-501.5037 862.2127,-494.5037"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M938.7974,-485.8191C916.9042,-474.3066 882.6679,-456.9237 852,-444.0036 822.4647,-431.5608 814.5155,-429.7998 784,-420.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M784,-420.0036C753.4845,-410.2075 745.7028,-408.0413 716,-396.0036 687.2892,-384.3681 655.3913,-369.5869 632.0836,-358.4318"/>
<polygon fill="#000000" stroke="#000000" points="633.4984,-355.2285 622.9698,-354.0453 630.4625,-361.5359 633.4984,-355.2285"/>
</g>
<!-- sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~korc_profiles.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/korc_profiles.f90.html" xlink:title="korc_profiles.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643.5,-274.0036 553.5,-274.0036 553.5,-250.0036 643.5,-250.0036 643.5,-274.0036"/>
<text text-anchor="middle" x="598.5" y="-259.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_profiles.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_profiles.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M954.3512,-485.7402C938.8823,-460.2279 899.8129,-401.0691 852,-368.0036 799.2801,-331.5447 775.066,-344.9005 716,-320.0036 686.3365,-307.5002 653.5659,-291.0984 630.1863,-278.9282"/>
<polygon fill="#000000" stroke="#000000" points="631.5722,-275.7029 621.0903,-274.16 628.3222,-281.9027 631.5722,-275.7029"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M598.5,-580.0036C562.9018,-568.7144 522.3186,-557.5107 491.0634,-549.234"/>
<polygon fill="#000000" stroke="#000000" points="491.8231,-545.8148 481.2615,-546.6533 490.0407,-552.5841 491.8231,-545.8148"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M905.7844,-510.1045C899.5451,-512.5573 893.4739,-515.4932 888,-519.0036 867.3046,-532.2756 873.9364,-549.9023 852,-561.0036 801.5955,-586.5117 652.3484,-597.0805 598.5,-580.0036"/>
</g>
<!-- sourcefile~korc_avalanche.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~korc_avalanche.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node15"><a xlink:href=".././sourcefile/korc_avalanche.f90.html" xlink:title="korc_avalanche.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="836,-552.0036 732,-552.0036 732,-528.0036 836,-528.0036 836,-552.0036"/>
<text text-anchor="middle" x="784" y="-537.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_avalanche.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_avalanche.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_avalanche.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M910.6356,-510.0392C890.1182,-514.894 866.2751,-520.5357 844.8477,-525.6059"/>
<polygon fill="#000000" stroke="#000000" points="843.7972,-522.2577 834.8718,-527.9664 845.409,-529.0696 843.7972,-522.2577"/>
</g>
<!-- sourcefile~korc_initialize.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~korc_initialize.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/korc_initialize.f90.html" xlink:title="korc_initialize.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1164,-552.0036 1071,-552.0036 1071,-528.0036 1164,-528.0036 1164,-552.0036"/>
<text text-anchor="middle" x="1117.5" y="-537.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_initialize.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1107.2502,-552.1176C1092.7381,-568.5546 1064.65,-597.8357 1035,-615.0036 863.8102,-714.1256 795.4294,-683.297 598.5,-702.0036"/>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M784,-382.0036C736.7894,-379.466 684.2164,-367.2035 647.1288,-356.9168"/>
<polygon fill="#000000" stroke="#000000" points="647.6714,-353.4329 637.0962,-354.0775 645.7652,-360.1684 647.6714,-353.4329"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1104.037,-527.7927C1088.3596,-514.0498 1061.2493,-491.7256 1035,-477.0036 930.9665,-418.6564 903.1065,-388.4059 784,-382.0036"/>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_spatial_distribution.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_spatial_distribution.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1072.7967,-527.9681C1055.0908,-523.2012 1034.567,-517.6755 1016.002,-512.6773"/>
<polygon fill="#000000" stroke="#000000" points="1016.776,-509.2611 1006.2099,-510.0409 1014.9561,-516.0204 1016.776,-509.2611"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~korc_velocity_distribution.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/korc_velocity_distribution.f90.html" xlink:title="korc_velocity_distribution.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1035,-552.0036 888,-552.0036 888,-528.0036 1035,-528.0036 1035,-552.0036"/>
<text text-anchor="middle" x="961.5" y="-537.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_velocity_distribution.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_velocity_distribution.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_velocity_distribution.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1070.6949,-540.0036C1062.6316,-540.0036 1054.0358,-540.0036 1045.3428,-540.0036"/>
<polygon fill="#000000" stroke="#000000" points="1045.1192,-536.5037 1035.1192,-540.0036 1045.1192,-543.5037 1045.1192,-536.5037"/>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1091.8836,-552.1274C1045.3772,-573.3922 943.4009,-616.6165 852,-632.0036 792.3943,-642.0381 772.3327,-653.9161 716,-632.0036 695.7714,-624.135 699.197,-609.1322 680,-599.0036 647.1044,-581.6475 634.0003,-591.0982 598.5,-580.0036"/>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M784,-382.0036C634.142,-350.6096 592.2812,-371.9579 439.5,-382.0036"/>
</g>
<!-- sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M292.5,-302.0036C228.7403,-309.6973 204.2055,-270.9321 148,-302.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.4276,-268.1792C493.7773,-276.287 385.3185,-290.8036 292.5,-302.0036"/>
</g>
<!-- sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.296,-268.289C540.1562,-272.0982 526.7377,-278.208 517,-288.0036 512.8554,-292.1729 464.0437,-454.0908 446.0807,-514.007"/>
<polygon fill="#000000" stroke="#000000" points="442.6201,-513.3628 443.1034,-523.9466 449.3257,-515.3715 442.6201,-513.3628"/>
</g>
<!-- sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M439.5,-382.0036C374.3074,-386.2902 356.6472,-369.611 292.5,-382.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.1436,-265.55C540.7239,-268.0468 527.7379,-272.1861 517,-279.0036 468.6356,-309.7105 496.6655,-378.2449 439.5,-382.0036"/>
</g>
<!-- sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_interp.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_interp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.2157,-250.0251C541.1826,-246.1815 528.3761,-241.4766 517,-236.0036 499.6715,-227.667 497.1494,-222.4427 481,-212.0036 476.6489,-209.1911 472.0178,-206.2443 467.4866,-203.3866"/>
<polygon fill="#000000" stroke="#000000" points="469.3267,-200.4093 458.9957,-198.0595 465.6065,-206.3389 469.3267,-200.4093"/>
</g>
<!-- sourcefile~korc_ppusher.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~korc_ppusher.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/korc_ppusher.f90.html" xlink:title="korc_ppusher.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1008.5,-259.0036 914.5,-259.0036 914.5,-235.0036 1008.5,-235.0036 1008.5,-259.0036"/>
<text text-anchor="middle" x="961.5" y="-244.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_ppusher.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M947.2731,-234.7778C927.2892,-218.2109 889.1744,-188.7798 852,-172.0036 746.0839,-124.2056 714.6812,-110.1949 598.5,-108.0036"/>
</g>
<!-- sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M914.228,-249.971C863.5971,-254.437 781.6705,-265.4197 716,-292.0036 698.1755,-299.2192 697.3285,-307.667 680,-316.0036 670.0606,-320.7854 659.0291,-324.9809 648.3757,-328.5279"/>
<polygon fill="#000000" stroke="#000000" points="647.204,-325.2278 638.7405,-331.6012 649.3312,-331.8968 647.204,-325.2278"/>
</g>
<!-- sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_profiles.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M784,-186.0036C752.4405,-183.8838 743.9262,-192.1503 716,-207.0036 697.8606,-216.6517 698.0945,-226.2716 680,-236.0036 671.6513,-240.494 662.3993,-244.3615 653.2134,-247.6375"/>
<polygon fill="#000000" stroke="#000000" points="652.0658,-244.3308 643.7054,-250.8388 654.2995,-250.9649 652.0658,-244.3308"/>
</g>
<!-- sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_interp.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge65" class="edge">
<title>sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_interp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M784,-186.0036C701.7361,-180.4779 680.8379,-179.7196 598.5,-184.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M939.0557,-234.9678C906.1448,-218.3366 842.3585,-189.9236 784,-186.0036"/>
</g>
<!-- sourcefile~korc_collisions.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~korc_collisions.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node19"><a xlink:href=".././sourcefile/korc_collisions.f90.html" xlink:title="korc_collisions.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="833,-240.0036 735,-240.0036 735,-216.0036 833,-216.0036 833,-240.0036"/>
<text text-anchor="middle" x="784" y="-225.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_collisions.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_collisions.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge70" class="edge">
<title>sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_collisions.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M914.3993,-241.9619C892.5695,-239.6252 866.392,-236.8231 843.2385,-234.3447"/>
<polygon fill="#000000" stroke="#000000" points="843.4979,-230.8525 833.1822,-233.2682 842.7528,-237.8128 843.4979,-230.8525"/>
</g>
<!-- sourcefile~korc_energy_pdfs.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~korc_energy_pdfs.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/korc_energy_pdfs.f90.html" xlink:title="korc_energy_pdfs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="655,-632.0036 542,-632.0036 542,-608.0036 655,-608.0036 655,-632.0036"/>
<text text-anchor="middle" x="598.5" y="-617.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_energy_pdfs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M292.5,-575.0036C232.5165,-552.0586 205.3072,-603.9928 148,-575.0036"/>
</g>
<!-- sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.2594,-607.9465C538.2698,-604.2706 526.9372,-599.6634 517,-594.0036 498.3982,-583.409 498.1302,-574.8422 481,-562.0036 477.1221,-559.0973 472.9136,-556.1961 468.7141,-553.442"/>
<polygon fill="#000000" stroke="#000000" points="470.5325,-550.4507 460.2153,-548.0408 466.7778,-556.3585 470.5325,-550.4507"/>
</g>
<!-- sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M541.7916,-609.9183C522.5217,-606.6066 500.8459,-603.0077 481,-600.0036 397.4405,-587.3555 373.2915,-599.8009 292.5,-575.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M292.5,-575.0036C215.589,-545.5835 171.5516,-447.4048 155.2826,-403.5194"/>
<polygon fill="#000000" stroke="#000000" points="158.5675,-402.3107 151.9026,-394.0749 151.9769,-404.6695 158.5675,-402.3107"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M950.2389,-552.2868C931.6235,-571.8882 892.4536,-610.2434 852,-632.0036 749.0638,-687.3736 715.1325,-694.353 598.5,-702.0036"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_experimental_pdf.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_experimental_pdf.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M910.6356,-527.9681C890.1182,-523.1133 866.2751,-517.4715 844.8477,-512.4014"/>
<polygon fill="#000000" stroke="#000000" points="845.409,-508.9377 834.8718,-510.0409 843.7972,-515.7496 845.409,-508.9377"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M905.7844,-527.9028C899.5451,-525.45 893.4739,-522.5141 888,-519.0036 867.3046,-505.7317 872.508,-490.5633 852,-477.0036 799.1199,-442.0399 772.0754,-463.5725 716,-434.0036 678.24,-414.0925 640.4125,-381.7014 618.2462,-361.143"/>
<polygon fill="#000000" stroke="#000000" points="620.4975,-358.4555 610.8173,-354.1492 615.6993,-363.5523 620.4975,-358.4555"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_energy_pdfs.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_energy_pdfs.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M784,-618.0036C745.3316,-626.4156 701.0492,-627.2134 665.4497,-625.7683"/>
<polygon fill="#000000" stroke="#000000" points="665.3299,-622.2587 655.175,-625.2799 664.9975,-629.2508 665.3299,-622.2587"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M784,-618.0036C773.7209,-620.2398 608.5274,-583.1836 598.5,-580.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M941.3769,-552.0688C909.3843,-570.4907 844.3546,-604.874 784,-618.0036"/>
</g>
<!-- sourcefile~korc_simple_equilibrium_pdf.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~korc_simple_equilibrium_pdf.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/korc_simple_equilibrium_pdf.f90.html" xlink:title="korc_simple_equilibrium_pdf.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="680,-674.0036 517,-674.0036 517,-650.0036 680,-650.0036 680,-674.0036"/>
<text text-anchor="middle" x="598.5" y="-659.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_simple_equilibrium_pdf.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_simple_equilibrium_pdf.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_simple_equilibrium_pdf.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M784,-618.0036C741.4299,-627.2644 693.5966,-638.634 657.1662,-647.4957"/>
<polygon fill="#000000" stroke="#000000" points="656.093,-644.1548 647.2072,-649.9248 657.7518,-650.9554 656.093,-644.1548"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_avalanche.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_avalanche.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M887.7661,-540.0036C873.9519,-540.0036 859.6378,-540.0036 846.2154,-540.0036"/>
<polygon fill="#000000" stroke="#000000" points="846.1481,-536.5037 836.1481,-540.0036 846.1481,-543.5037 846.1481,-536.5037"/>
</g>
<!-- sourcefile~korc_hdf5.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~korc_hdf5.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M397.8775,-531.6439C368.2015,-529.5892 327.5211,-528.9257 292.5,-536.0036"/>
</g>
<!-- sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M292.5,-613.0036C233.9599,-581.6543 207.2557,-604.9785 148,-575.0036"/>
</g>
<!-- sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M533.9423,-649.8804C527.9662,-647.444 522.2082,-644.5178 517,-641.0036 500.4514,-629.8377 469.9623,-584.2898 452.5668,-556.9859"/>
<polygon fill="#000000" stroke="#000000" points="455.3023,-554.7626 447.0041,-548.1754 449.3833,-558.4996 455.3023,-554.7626"/>
</g>
<!-- sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M292.5,-613.0036C262.1305,-600.9375 246.2812,-611.9359 223,-589.0036 170.5048,-537.2954 154.5415,-446.0845 149.8585,-404.1843"/>
<polygon fill="#000000" stroke="#000000" points="153.3372,-403.7963 148.8552,-394.1962 146.3723,-404.4959 153.3372,-403.7963"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M516.692,-658.6022C453.5407,-653.703 364.9999,-641.8087 292.5,-613.0036"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1254,-552.0036 1200,-552.0036 1200,-528.0036 1254,-528.0036 1254,-552.0036"/>
<text text-anchor="middle" x="1227" y="-537.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M292.5,-184.0036C265.2245,-199.7797 249.4869,-180.9367 223,-198.0036 175.0958,-228.8709 197.8741,-274.4322 148,-302.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1225.5898,-527.7415C1220.0919,-485.4635 1196.3395,-344.147 1117.5,-267.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M439.5,-70.0036C420.6001,-75.2414 414.7176,-74.7487 398,-85.0036 343.1899,-118.6253 348.1607,-151.8097 292.5,-184.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M598.5,-70.0036C530.2091,-88.1731 507.5999,-51.1309 439.5,-70.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M961.5,-72.0036C912.4247,-45.6395 905.9194,-25.009 852,-11.0036 793.4969,4.1923 774.8157,2.9337 716,-11.0036 659.1387,-24.4778 654.9714,-54.9788 598.5,-70.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M148,-302.0036C115.235,-320.1168 80.6825,-346.1362 58.8823,-363.5308"/>
<polygon fill="#000000" stroke="#000000" points="56.4944,-360.9602 50.909,-369.9633 60.8897,-366.4084 56.4944,-360.9602"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1117.5,-267.0036C1038.1713,-189.3816 1059.7818,-123.5682 961.5,-72.0036"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M784,-306.0036C736.6241,-305.4929 683.6645,-317.0159 646.4992,-327.1576"/>
<polygon fill="#000000" stroke="#000000" points="645.1393,-323.9036 636.4533,-329.9703 647.0266,-330.6444 645.1393,-323.9036"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_finalize.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_finalize.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M961.5,-72.0036C922.9346,-51.9763 874.5611,-41.9225 838.0569,-36.9065"/>
<polygon fill="#000000" stroke="#000000" points="838.4593,-33.4295 828.0936,-35.6212 837.5636,-40.372 838.4593,-33.4295"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_initialize.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_initialize.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1199.9326,-540.0036C1192.1101,-540.0036 1183.2644,-540.0036 1174.3445,-540.0036"/>
<polygon fill="#000000" stroke="#000000" points="1174.2927,-536.5037 1164.2927,-540.0036 1174.2927,-543.5037 1174.2927,-536.5037"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_profiles.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M961.5,-306.0036C882.6192,-307.1355 862.8843,-306.854 784,-306.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M784,-306.0036C733.2628,-305.4567 676.7716,-289.7864 639.612,-277.3017"/>
<polygon fill="#000000" stroke="#000000" points="640.7257,-273.9836 630.1311,-274.044 638.451,-280.6037 640.7257,-273.9836"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_ppusher.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_ppusher.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1117.5,-267.0036C1092.0312,-242.0827 1051.9903,-237.3723 1018.8524,-238.743"/>
<polygon fill="#000000" stroke="#000000" points="1018.5849,-235.2527 1008.8136,-239.348 1019.0061,-242.24 1018.5849,-235.2527"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1200.4834,-552.0556C1163.9034,-568.2873 1095.5979,-597.1876 1035,-615.0036 898.0672,-655.2625 842.1302,-718.8057 716,-652.0036 690.8358,-638.676 703.4764,-615.1195 680,-599.0036 649.3362,-577.9539 634.119,-590.7109 598.5,-580.0036"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M598.5,-70.0036C508.6968,-93.7478 469.7557,-70.0162 398,-129.0036 371.2799,-150.9691 388.5676,-175.8539 362,-198.0036 312.3312,-239.4131 271.971,-198.7713 223,-241.0036 194.9997,-265.151 204.4212,-283.3905 187,-316.0036 178.8253,-331.307 168.8632,-348.1388 161.0538,-360.9743"/>
<polygon fill="#000000" stroke="#000000" points="158.048,-359.1807 155.8041,-369.5352 164.0154,-362.84 158.048,-359.1807"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_interp.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge66" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_interp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M598.5,-184.0036C562.5848,-185.8723 522.0482,-186.357 490.8942,-186.3824"/>
<polygon fill="#000000" stroke="#000000" points="490.7115,-182.8824 480.7088,-186.3748 490.7062,-189.8824 490.7115,-182.8824"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M961.5,-72.0036C932.4172,-56.9007 711.3579,-150.4858 680,-160.0036 643.8676,-170.9706 636.2091,-182.0416 598.5,-184.0036"/>
</g>
<!-- sourcefile~korc_units.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~korc_units.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node18"><a xlink:href=".././sourcefile/korc_units.f90.html" xlink:title="korc_units.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="331.5,-274.0036 253.5,-274.0036 253.5,-250.0036 331.5,-250.0036 331.5,-274.0036"/>
<text text-anchor="middle" x="292.5" y="-259.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_units.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_units.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge69" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_units.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M961.5,-72.0036C913.3921,-45.8556 766.8137,-72.6063 716,-93.0036 696.9332,-100.6574 698.804,-113.7251 680,-122.0036 563.9653,-173.0882 500.7098,-90.6775 398,-165.0036 369.3375,-185.7453 388.3701,-212.4161 362,-236.0036 355.9913,-241.3783 348.7673,-245.6789 341.2812,-249.1095"/>
<polygon fill="#000000" stroke="#000000" points="339.6681,-245.9874 331.7304,-253.0048 342.3117,-252.469 339.6681,-245.9874"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_collisions.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge71" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_collisions.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1117.5,-267.0036C1066.4186,-217.0212 1032.9598,-304.9782 961.5,-306.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M961.5,-306.0036C902.125,-306.8556 840.291,-269.4925 807.5832,-246.1791"/>
<polygon fill="#000000" stroke="#000000" points="809.2952,-243.0951 799.1566,-240.0195 805.1643,-248.7464 809.2952,-243.0951"/>
</g>
<!-- sourcefile~korc_input.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~korc_input.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M108.6893,-382.0036C100.4876,-382.0036 91.7645,-382.0036 83.3219,-382.0036"/>
<polygon fill="#000000" stroke="#000000" points="83.2169,-378.5037 73.2168,-382.0036 83.2168,-385.5037 83.2169,-378.5037"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M598.5,-702.0036C428.3284,-704.1582 379.6303,-693.5615 223,-627.0036 185.6691,-611.1404 184.1941,-593.3127 148,-575.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M768.0073,-552.0315C753.0403,-563.929 730.8228,-583.3124 716,-604.0036 693.5295,-635.3703 709.8533,-658.5584 680,-683.0036 651.2232,-706.5674 635.6138,-699.5691 598.5,-702.0036"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M731.8587,-528.9293C726.1249,-526.2962 720.6794,-523.0371 716,-519.0036 687.9938,-494.8631 699.6664,-475.3141 680,-444.0036 660.8206,-413.4684 634.0062,-381.4954 616.4521,-361.6628"/>
<polygon fill="#000000" stroke="#000000" points="619.0442,-359.3109 609.7679,-354.1923 613.8275,-363.9785 619.0442,-359.3109"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_profiles.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M731.734,-530.573C725.806,-527.6735 720.3453,-523.9028 716,-519.0036 656.65,-452.089 727.6639,-396.6882 680,-321.0036 668.8472,-303.2943 650.282,-289.2382 633.6856,-279.2947"/>
<polygon fill="#000000" stroke="#000000" points="635.1498,-276.101 624.7275,-274.1966 631.6875,-282.1847 635.1498,-276.101"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M598.5,-496.0036C554.5439,-491.0019 505.3549,-506.8171 473.4887,-520.0162"/>
<polygon fill="#000000" stroke="#000000" points="471.995,-516.8483 464.1803,-524.0025 474.7507,-523.2831 471.995,-516.8483"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M745.3958,-527.9882C708.2027,-517.0967 650.1313,-501.8787 598.5,-496.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M598.5,-496.0036C446.1012,-478.6623 271.5962,-424.2036 191.8719,-397.3223"/>
<polygon fill="#000000" stroke="#000000" points="192.7662,-393.9298 182.1718,-394.0296 190.516,-400.5583 192.7662,-393.9298"/>
</g>
<!-- sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M398.3021,-174.6871C367.1453,-168.5556 324.4254,-165.5381 292.5,-184.0036"/>
</g>
<!-- sourcefile~korc_m3d_c1_interface.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~korc_m3d_c1_interface.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node17"><a xlink:href=".././sourcefile/korc_m3d_c1_interface.f90.html" xlink:title="korc_m3d_c1_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="362,-354.0036 223,-354.0036 223,-330.0036 362,-330.0036 362,-354.0036"/>
<text text-anchor="middle" x="292.5" y="-339.6036" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_m3d_c1_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_m3d_c1_interface.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge68" class="edge">
<title>sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_m3d_c1_interface.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M431.2644,-198.0989C422.6824,-210.8402 408.9803,-231.5736 398,-250.0036 380.8982,-278.7086 387.2363,-294.1045 362,-316.0036 357.8039,-319.6448 353.0493,-322.7971 348.0434,-325.5218"/>
<polygon fill="#000000" stroke="#000000" points="346.307,-322.4736 338.8278,-329.9778 349.3542,-328.7756 346.307,-322.4736"/>
</g>
<!-- sourcefile~korc_m3d_c1_interface.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~korc_m3d_c1_interface.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M249.1452,-354.005C232.7449,-358.5448 213.9664,-363.743 197.0773,-368.4182"/>
<polygon fill="#000000" stroke="#000000" points="196.0876,-365.0605 187.3838,-371.1015 197.9552,-371.8068 196.0876,-365.0605"/>
</g>
<!-- sourcefile~korc_units.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~korc_units.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M277.8494,-274.1703C252.5339,-295.1935 200.4458,-338.45 170.506,-363.3135"/>
<polygon fill="#000000" stroke="#000000" points="168.1465,-360.7234 162.6894,-369.8048 172.6186,-366.1086 168.1465,-360.7234"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M739.1438,-240.1554C730.876,-243.7287 722.7384,-248.2705 716,-254.0036 691.7314,-274.6517 704.8411,-296.0479 680,-316.0036 670.8656,-323.3416 659.6213,-328.626 648.4349,-332.4258"/>
<polygon fill="#000000" stroke="#000000" points="647.2212,-329.1366 638.6739,-335.3971 649.2597,-335.8332 647.2212,-329.1366"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_profiles.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M734.7764,-237.0258C709.7608,-241.6108 679.2819,-247.1973 653.497,-251.9233"/>
<polygon fill="#000000" stroke="#000000" points="652.7057,-248.51 643.5005,-253.7556 653.9677,-255.3953 652.7057,-248.51"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M746.3334,-240.0067C736.1902,-243.8756 725.4239,-248.5871 716,-254.0036 698.1871,-264.242 698.4682,-274.0008 680,-283.0036 613.1346,-315.5989 572.5832,-271.5674 517,-321.0036 501.9182,-334.4176 461.8485,-462.3413 446.0426,-514.264"/>
<polygon fill="#000000" stroke="#000000" points="442.6881,-513.2656 443.1375,-523.8509 449.3872,-515.2958 442.6881,-513.2656"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M598.5,-222.0036C561.3073,-221.7532 550.5242,-224.8951 517,-241.0036 437.9806,-278.9729 440.2873,-323.5469 362,-363.0036 333.4042,-377.4159 323.941,-375.9295 292.5,-382.0036"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M292.5,-382.0036C261.0869,-386.2518 225.48,-386.3063 197.4723,-385.2721"/>
<polygon fill="#000000" stroke="#000000" points="197.2755,-381.7605 187.1347,-384.8288 196.9756,-388.7541 197.2755,-381.7605"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_interp.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge67" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_interp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M598.5,-222.0036C558.6602,-221.7354 514.5595,-210.8774 482.9293,-201.1567"/>
<polygon fill="#000000" stroke="#000000" points="483.7091,-197.7326 473.1192,-198.0555 481.5991,-204.407 483.7091,-197.7326"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M734.8026,-225.7263C697.4245,-224.1626 644.7371,-222.315 598.5,-222.0036"/>
</g>
</g>
</svg>
</div><script>var pansourcefilekorc_hpcf90AfferentGraph = svgPanZoom('#sourcefilekorc_hpcf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/korc_hpc.html">korc_hpc</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/korc_hpc.f90.html#src">korc_hpc.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">korc_hpc</span>
<a name="ln-2"></a>  <span class="c">!! @note KORC module containing subroutines to initilize, control, </span>
<a name="ln-3"></a>  <span class="c">!! and to finalize parallel communications. @endnote</span>
<a name="ln-4"></a>  <span class="k">use </span><span class="n">korc_types</span>
<a name="ln-5"></a>  <span class="k">use </span><span class="n">omp_lib</span>
<a name="ln-6"></a>  <span class="k">use </span><span class="n">mpi</span>
<a name="ln-7"></a>
<a name="ln-8"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-9"></a>
<a name="ln-10"></a><span class="k">  </span><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">timed_already</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> 
<a name="ln-11"></a>  <span class="c">!! Flag to determine if a first call to WMPI_TIME() was made already.</span>
<a name="ln-12"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">t1</span> 
<a name="ln-13"></a>  <span class="c">!! Variable to be used in timing a parallel section of KORC.</span>
<a name="ln-14"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">t2</span> 
<a name="ln-15"></a>  <span class="c">!! Variable to be used in timing a parallel section of KORC.</span>
<a name="ln-16"></a>
<a name="ln-17"></a>  <span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">korc_abort</span><span class="p">,&amp;</span>
<a name="ln-18"></a>       <span class="n">initialize_mpi</span><span class="p">,&amp;</span>
<a name="ln-19"></a>       <span class="n">finalize_mpi</span><span class="p">,&amp;</span>
<a name="ln-20"></a>       <span class="n">initialize_communications</span><span class="p">,&amp;</span>
<a name="ln-21"></a>       <span class="n">timing_KORC</span>
<a name="ln-22"></a>
<a name="ln-23"></a><span class="k">CONTAINS</span>
<a name="ln-24"></a>
<a name="ln-25"></a><span class="k">  subroutine </span><span class="n">korc_abort</span><span class="p">()</span>
<a name="ln-26"></a>    <span class="c">!! @note Subroutine that terminates the simulation. @endnote</span>
<a name="ln-27"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">mpierr</span> 
<a name="ln-28"></a>    <span class="c">!! MPI error status</span>
<a name="ln-29"></a>
<a name="ln-30"></a>    <span class="k">call </span><span class="n">MPI_BARRIER</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-31"></a>
<a name="ln-32"></a>    <span class="k">call </span><span class="n">MPI_ABORT</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-33"></a>  <span class="k">end subroutine </span><span class="n">korc_abort</span>
<a name="ln-34"></a>
<a name="ln-35"></a>  <span class="k">subroutine </span><span class="n">set_paths</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-36"></a>    <span class="c">!! @note Subroutine that sets the input/output paths.@endnote</span>
<a name="ln-37"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">KORC_PARAMS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">params</span>
<a name="ln-38"></a>    <span class="c">!! Core KORC simulation parameters.</span>
<a name="ln-39"></a>    <span class="kt">INTEGER</span> 				<span class="kd">::</span> <span class="n">argn</span><span class="p">,</span><span class="n">read_stat</span><span class="p">,</span><span class="n">exei</span>
<a name="ln-40"></a>    <span class="c">!! Number of command line inputs. The default value is </span>
<a name="ln-41"></a>    <span class="c">!! two: the input files path and the outputs path.</span>
<a name="ln-42"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="n">MAX_STRING_LENGTH</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ctmp</span>
<a name="ln-43"></a>
<a name="ln-44"></a>    <span class="n">argn</span> <span class="o">=</span> <span class="nb">command_argument_count</span><span class="p">()</span>
<a name="ln-45"></a>
<a name="ln-46"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">argn</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">2_idef</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-47"></a><span class="k">       call </span><span class="nb">get_command_argument</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">path_to_inputs</span><span class="p">)</span>
<a name="ln-48"></a>       <span class="k">call </span><span class="nb">get_command_argument</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">path_to_outputs</span><span class="p">)</span>
<a name="ln-49"></a>    <span class="k">else</span>
<a name="ln-50"></a><span class="k">       call </span><span class="n">korc_abort</span><span class="p">()</span>
<a name="ln-51"></a>    <span class="k">end if</span>
<a name="ln-52"></a>
<a name="ln-53"></a>    <span class="c">!write(6,*) TRIM(params%path_to_outputs)</span>
<a name="ln-54"></a>    <span class="c">!write(6,*) TRIM(params%path_to_inputs)</span>
<a name="ln-55"></a>    
<a name="ln-56"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-57"></a>
<a name="ln-58"></a><span class="k">       OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">output_unit_write</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-59"></a>            <span class="k">FILE</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">path_to_outputs</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;output.korc&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-60"></a>            <span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;UNKNOWN&#39;</span><span class="p">,</span><span class="n">FORM</span><span class="o">=</span><span class="s1">&#39;FORMATTED&#39;</span><span class="p">,</span><span class="n">POSITION</span><span class="o">=</span><span class="s1">&#39;REWIND&#39;</span><span class="p">)</span>
<a name="ln-61"></a>       
<a name="ln-62"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * PATHS * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-63"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;The input file is: &#39;</span><span class="p">,&amp;</span>
<a name="ln-64"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">path_to_inputs</span><span class="p">)</span>
<a name="ln-65"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/)&#39;</span><span class="p">)</span>      
<a name="ln-66"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;The output folder is: &#39;</span><span class="p">,&amp;</span>
<a name="ln-67"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">path_to_outputs</span><span class="p">)</span>
<a name="ln-68"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(&quot;* * * * * * * * * * * * *&quot;,/)&#39;</span><span class="p">)</span>      
<a name="ln-69"></a>
<a name="ln-70"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * GIT INFO * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-71"></a>
<a name="ln-72"></a><span class="cp">#ifdef MAC</span>
<a name="ln-73"></a>       <span class="k">call </span><span class="nb">execute_command_line</span><span class="p">(</span><span class="s2">&quot;/Users/21b/Desktop/KORC/src/get_git_details.sh&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-74"></a>            <span class="n">exitstat</span><span class="o">=</span><span class="n">exei</span><span class="p">)</span>
<a name="ln-75"></a><span class="cp">#elif CORI</span>
<a name="ln-76"></a>       <span class="k">call </span><span class="nb">execute_command_line</span><span class="p">(</span><span class="s2">&quot;/global/u1/m/mbeidler/KORC/src/get_git_details.sh&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-77"></a>            <span class="n">exitstat</span><span class="o">=</span><span class="n">exei</span><span class="p">)</span>
<a name="ln-78"></a><span class="cp">#endif</span>
<a name="ln-79"></a>
<a name="ln-80"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">exei</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-81"></a><span class="k">          write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Error executing get_git_details.sh&#39;</span>
<a name="ln-82"></a>          <span class="k">call </span><span class="n">korc_abort</span>
<a name="ln-83"></a>       <span class="k">end if</span>
<a name="ln-84"></a><span class="k">       </span>
<a name="ln-85"></a><span class="k">       OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">default_unit_open</span><span class="p">,</span><span class="k">FILE</span><span class="o">=</span><span class="s1">&#39;git_hash.txt&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-86"></a>            <span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;OLD&#39;</span><span class="p">,</span><span class="n">POSITION</span><span class="o">=</span><span class="s1">&#39;REWIND&#39;</span><span class="p">)</span>
<a name="ln-87"></a>       <span class="k">READ</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">default_unit_open</span><span class="p">,</span><span class="n">FMT</span><span class="o">=</span><span class="s1">&#39;(a)&#39;</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">read_stat</span><span class="p">)</span> <span class="n">ctmp</span>
<a name="ln-88"></a>       
<a name="ln-89"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">read_stat</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-90"></a><span class="k">          write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Error reading git_hash.txt&#39;</span>
<a name="ln-91"></a>          <span class="k">call </span><span class="n">korc_abort</span>
<a name="ln-92"></a>       <span class="k">end if</span>
<a name="ln-93"></a><span class="k">       write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Git hash of most recent commit is: &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-94"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">ctmp</span><span class="p">)</span>
<a name="ln-95"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/)&#39;</span><span class="p">)</span>      
<a name="ln-96"></a>       <span class="k">CLOSE</span><span class="p">(</span><span class="n">default_unit_open</span><span class="p">)</span>
<a name="ln-97"></a>
<a name="ln-98"></a>       <span class="k">OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">default_unit_open</span><span class="p">,</span><span class="k">FILE</span><span class="o">=</span><span class="s1">&#39;git_diff.txt&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-99"></a>            <span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;OLD&#39;</span><span class="p">,</span><span class="n">POSITION</span><span class="o">=</span><span class="s1">&#39;REWIND&#39;</span><span class="p">)</span>
<a name="ln-100"></a>
<a name="ln-101"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Git diff of HEAD and most recent commit is:&#39;</span>
<a name="ln-102"></a>       <span class="k">DO</span>
<a name="ln-103"></a><span class="k">          READ</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">default_unit_open</span><span class="p">,</span><span class="n">FMT</span><span class="o">=</span><span class="s1">&#39;(a)&#39;</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">read_stat</span><span class="p">)</span> <span class="n">ctmp</span>
<a name="ln-104"></a>          
<a name="ln-105"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">read_stat</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-106"></a><span class="k">             write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Error reading git_diff.txt&#39;</span>
<a name="ln-107"></a>             <span class="k">call </span><span class="n">korc_abort</span>
<a name="ln-108"></a>          <span class="k">else if</span> <span class="p">(</span><span class="n">read_stat</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-109"></a><span class="k">             CLOSE</span><span class="p">(</span><span class="n">default_unit_open</span><span class="p">)</span>
<a name="ln-110"></a>       
<a name="ln-111"></a>             <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(&quot;* * * * * * * * * * * * * * * * *&quot;,/)&#39;</span><span class="p">)</span>
<a name="ln-112"></a>             <span class="k">RETURN</span>
<a name="ln-113"></a><span class="k">          end if</span>
<a name="ln-114"></a><span class="k">          write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ctmp</span><span class="p">)</span>
<a name="ln-115"></a>       <span class="k">END DO</span>
<a name="ln-116"></a>
<a name="ln-117"></a><span class="k">     </span>
<a name="ln-118"></a><span class="k">    end if</span>
<a name="ln-119"></a><span class="k">  end subroutine </span><span class="n">set_paths</span>
<a name="ln-120"></a>
<a name="ln-121"></a>  <span class="k">subroutine </span><span class="n">initialize_mpi</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-122"></a>    <span class="c">!! @note Subroutine that initialize MPI communications.@endnote</span>
<a name="ln-123"></a>    <span class="c">!! Through this subroutine the default MPI communicator MPI_COMM_WORLD </span>
<a name="ln-124"></a>    <span class="c">!! is initialized. Also, a Cartesian</span>
<a name="ln-125"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">KORC_PARAMS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">params</span>
<a name="ln-126"></a>    <span class="c">!! Core KORC simulation parameters.</span>
<a name="ln-127"></a>    <span class="kt">INTEGER</span> 				<span class="kd">::</span> <span class="n">mpierr</span>
<a name="ln-128"></a>    <span class="c">!! MPI error status.</span>
<a name="ln-129"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> 			<span class="kd">::</span> <span class="n">NDIMS</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-130"></a>    <span class="c">!! Number of dimensions of non-standard topology. </span>
<a name="ln-131"></a>    <span class="c">!! NDIMS=1 for a 1-D MPI topology, NDIMS=2 for a 2-D MPI topology, </span>
<a name="ln-132"></a>    <span class="c">!! and NDIMS=3 for a 3-D MPI topology.</span>
<a name="ln-133"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> 	<span class="kd">::</span> <span class="n">DIMS</span>
<a name="ln-134"></a>    <span class="c">!! Dimension of the non-standard MPI topology params::mpi_params::mpi_topo. </span>
<a name="ln-135"></a>    <span class="c">!! This is equal to the number of MPI processes in KORC.</span>
<a name="ln-136"></a>    <span class="kt">LOGICAL</span> 				<span class="kd">::</span> <span class="n">all_mpis_initialized</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-137"></a>    <span class="c">!! Flag to determine if all the MPI processes were initialized correctly.</span>
<a name="ln-138"></a>    <span class="kt">LOGICAL</span> 				<span class="kd">::</span> <span class="n">mpi_process_initialized</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-139"></a>    <span class="c">!! Flag to determine if a given MPI process was initialized correctly.</span>
<a name="ln-140"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">PARAMETER</span> 			<span class="kd">::</span> <span class="n">REORDER</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-141"></a>    <span class="c">!! Flag to determine if the new MPI topology params::mpi_params::mpi_topo </span>
<a name="ln-142"></a>    <span class="c">!! needs to be re-ordered.</span>
<a name="ln-143"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> 	<span class="kd">::</span> <span class="n">PERIODS</span> <span class="c">!&lt; Something here</span>
<a name="ln-144"></a>    <span class="c">!! Array of logicals determining what dimensions of the new MPI </span>
<a name="ln-145"></a>    <span class="c">!! topology params::mpi_params::mpi_topo are periodic (T) or not (F).</span>
<a name="ln-146"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ii</span>
<a name="ln-147"></a>    <span class="c">!! Variable to iterate over different MPI processes.</span>
<a name="ln-148"></a>
<a name="ln-149"></a>    <span class="k">call </span><span class="n">MPI_INIT</span><span class="p">(</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-150"></a>
<a name="ln-151"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">mpierr</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">MPI_SUCCESS</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-152"></a><span class="k">       write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * COMMUNICATIONS * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-153"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot; ERROR: Initializing MPI. Aborting... &quot;)&#39;</span><span class="p">)</span>
<a name="ln-154"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * * * ** * * * * * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-155"></a>       <span class="k">call </span><span class="n">MPI_ABORT</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-156"></a>    <span class="k">end if</span>
<a name="ln-157"></a>
<a name="ln-158"></a><span class="k">    call </span><span class="n">MPI_INITIALIZED</span><span class="p">(</span><span class="n">mpi_process_initialized</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-159"></a>
<a name="ln-160"></a>    <span class="k">call </span><span class="n">MPI_REDUCE</span><span class="p">(</span><span class="n">mpi_process_initialized</span><span class="p">,</span><span class="n">all_mpis_initialized</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-161"></a>         <span class="n">MPI_LOGICAL</span><span class="p">,</span><span class="n">MPI_LAND</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-162"></a>
<a name="ln-163"></a>    <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">all_mpis_initialized</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-164"></a>         <span class="n">MPI_LOGICAL</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-165"></a>
<a name="ln-166"></a>    <span class="k">call </span><span class="n">MPI_COMM_SIZE</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">nmpi</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-167"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">mpierr</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">MPI_SUCCESS</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-168"></a><span class="k">       write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * COMMUNICATIONS * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-169"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot; ERROR: Obtaining size of communicator. Aborting... &quot;)&#39;</span><span class="p">)</span>
<a name="ln-170"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * * * ** * * * * * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-171"></a>       <span class="k">call </span><span class="n">MPI_ABORT</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-172"></a>    <span class="k">end if</span>
<a name="ln-173"></a>
<a name="ln-174"></a>    <span class="c">! * * * Getting the rank of the MPI process in the WORLD COMMON communicator * * * !</span>
<a name="ln-175"></a>    <span class="k">call </span><span class="n">MPI_COMM_RANK</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-176"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">mpierr</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">MPI_SUCCESS</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-177"></a><span class="k">       write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * COMMUNICATIONS * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-178"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot; ERROR: Obtaining MPI rank. Aborting... &quot;)&#39;</span><span class="p">)</span>
<a name="ln-179"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * * * ** * * * * * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-180"></a>       <span class="k">call </span><span class="n">MPI_ABORT</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-181"></a>    <span class="k">end if</span>
<a name="ln-182"></a>    
<a name="ln-183"></a>    <span class="c">! * * * Here a Cartesian topology for MPI is created * * * !</span>
<a name="ln-184"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DIMS</span><span class="p">(</span><span class="n">NDIMS</span><span class="p">))</span>
<a name="ln-185"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PERIODS</span><span class="p">(</span><span class="n">NDIMS</span><span class="p">))</span>
<a name="ln-186"></a>
<a name="ln-187"></a>    <span class="c">! This loop isn&#39;t necessary but helps to do things more general in the future</span>
<a name="ln-188"></a>    <span class="k">do </span><span class="n">ii</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">NDIMS</span>
<a name="ln-189"></a>       <span class="n">DIMS</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">nmpi</span>
<a name="ln-190"></a>       <span class="n">PERIODS</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-191"></a>    <span class="k">end do</span>
<a name="ln-192"></a>
<a name="ln-193"></a>    <span class="c">! * * * Here a periodic topology for MPI is created * * * !</span>
<a name="ln-194"></a>    <span class="k">call </span><span class="n">MPI_CART_CREATE</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="n">NDIMS</span><span class="p">,</span> <span class="n">DIMS</span><span class="p">,</span> <span class="n">PERIODS</span><span class="p">,</span> <span class="n">REORDER</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-195"></a>         <span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">mpi_topo</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-196"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">mpierr</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">MPI_SUCCESS</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-197"></a><span class="k">       write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * COMMUNICATIONS * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-198"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot; ERROR: Creating new MPI topology. Aborting... &quot;)&#39;</span><span class="p">)</span>
<a name="ln-199"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * * * ** * * * * * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-200"></a>       <span class="k">call </span><span class="n">MPI_ABORT</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-201"></a>    <span class="k">end if</span>
<a name="ln-202"></a>
<a name="ln-203"></a>    <span class="c">! * * * Getting the rank of the MPI process in the new topology * * * !</span>
<a name="ln-204"></a>    <span class="k">call </span><span class="n">MPI_COMM_RANK</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">mpi_topo</span><span class="p">,</span> <span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank_topo</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-205"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">mpierr</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">MPI_SUCCESS</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-206"></a><span class="k">       write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * COMMUNICATIONS * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-207"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot; ERROR: Obtaining new MPI topology ranks. Aborting... &quot;)&#39;</span><span class="p">)</span>
<a name="ln-208"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * * * ** * * * * * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-209"></a>       <span class="k">call </span><span class="n">MPI_ABORT</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-210"></a>    <span class="k">end if</span>
<a name="ln-211"></a>
<a name="ln-212"></a><span class="k">    DEALLOCATE</span><span class="p">(</span><span class="n">DIMS</span><span class="p">)</span>
<a name="ln-213"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">PERIODS</span><span class="p">)</span>
<a name="ln-214"></a>
<a name="ln-215"></a>
<a name="ln-216"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">all_mpis_initialized</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-217"></a>
<a name="ln-218"></a><span class="k">       call </span><span class="n">MPI_BARRIER</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-219"></a>
<a name="ln-220"></a>       <span class="k">call </span><span class="n">set_paths</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-221"></a>       
<a name="ln-222"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-223"></a><span class="k">          write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * COMMUNICATIONS  * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-224"></a>          <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;  MPI communications initialized!  &quot;)&#39;</span><span class="p">)</span>
<a name="ln-225"></a>          <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;  Number of MPI processes: &quot;,I5)&#39;</span><span class="p">)</span> <span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">nmpi</span>
<a name="ln-226"></a>          <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * * * * * * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-227"></a>       <span class="k">end if</span>
<a name="ln-228"></a><span class="k">    else</span>
<a name="ln-229"></a><span class="k">       if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-230"></a><span class="k">          write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * COMMUNICATIONS * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-231"></a>          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot; ERROR: MPI not initialized. Aborting... &quot;)&#39;</span><span class="p">)</span>
<a name="ln-232"></a>          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * * * ** * * * * * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-233"></a>          <span class="k">call </span><span class="n">MPI_ABORT</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-234"></a>       <span class="k">end if</span>
<a name="ln-235"></a><span class="k">    end if</span>
<a name="ln-236"></a> 
<a name="ln-237"></a>    <span class="c">!...</span>
<a name="ln-238"></a>  <span class="k">end subroutine </span><span class="n">initialize_mpi</span>
<a name="ln-239"></a>
<a name="ln-240"></a>
<a name="ln-241"></a>  <span class="k">subroutine </span><span class="n">timing_KORC</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-242"></a>    <span class="c">!! @note Subroutine for timing the execution of any parallel</span>
<a name="ln-243"></a>    <span class="c">!! section of KORC. @endnote</span>
<a name="ln-244"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">KORC_PARAMS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">params</span>
<a name="ln-245"></a>    <span class="c">!! Core KORC simulation parameters.</span>
<a name="ln-246"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> 				<span class="kd">::</span> <span class="n">individual_runtime</span>
<a name="ln-247"></a>    <span class="c">!! Execution time of each MPI process.</span>
<a name="ln-248"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span>   <span class="kd">::</span> <span class="n">runtime</span>
<a name="ln-249"></a>    <span class="c">!! Execution time of KORC defined as the average of the </span>
<a name="ln-250"></a>    <span class="c">!! execution times of all MPI processes.</span>
<a name="ln-251"></a>    <span class="kt">INTEGER</span> 				<span class="kd">::</span> <span class="n">mpierr</span>
<a name="ln-252"></a>    <span class="c">!! MPI error status.</span>
<a name="ln-253"></a>    
<a name="ln-254"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">timed_already</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-255"></a><span class="k">       </span><span class="n">t2</span> <span class="o">=</span> <span class="n">MPI_WTIME</span><span class="p">()</span>
<a name="ln-256"></a>
<a name="ln-257"></a>       <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">runtime</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">nmpi</span><span class="p">))</span>
<a name="ln-258"></a>
<a name="ln-259"></a>       <span class="n">individual_runtime</span> <span class="o">=</span> <span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span>
<a name="ln-260"></a>
<a name="ln-261"></a>       <span class="k">call </span><span class="n">MPI_BARRIER</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-262"></a>
<a name="ln-263"></a>       <span class="k">call </span><span class="n">MPI_GATHER</span><span class="p">(</span><span class="n">individual_runtime</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">MPI_DOUBLE_PRECISION</span><span class="p">,</span><span class="n">runtime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-264"></a>            <span class="mi">1</span><span class="p">,</span><span class="n">MPI_DOUBLE_PRECISION</span><span class="p">,</span><span class="mi">0_idef</span><span class="p">,</span> <span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-265"></a>
<a name="ln-266"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0_idef</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-267"></a><span class="k">          write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(&quot;Timing: &quot;,F30.16,&quot; s&quot;)&#39;</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-268"></a>               <span class="nb">SUM</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">nmpi</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span>
<a name="ln-269"></a>       <span class="k">end if</span>
<a name="ln-270"></a>
<a name="ln-271"></a><span class="k">       call </span><span class="n">MPI_BARRIER</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-272"></a>
<a name="ln-273"></a>       <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span>
<a name="ln-274"></a>
<a name="ln-275"></a>       <span class="n">timed_already</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-276"></a>    <span class="k">end if</span>
<a name="ln-277"></a>
<a name="ln-278"></a><span class="k">    </span><span class="n">t1</span> <span class="o">=</span> <span class="n">MPI_WTIME</span><span class="p">()</span>
<a name="ln-279"></a>
<a name="ln-280"></a>    <span class="n">timed_already</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-281"></a>    
<a name="ln-282"></a>  <span class="k">end subroutine </span><span class="n">timing_KORC</span>
<a name="ln-283"></a>
<a name="ln-284"></a>  <span class="c">!&gt; @brief Subroutine for finalizing MPI communications.</span>
<a name="ln-285"></a>  <span class="c">!! @details This subroutine finalizes all the MPI communications and looks for errors durignt this procces.</span>
<a name="ln-286"></a>  <span class="c">!!</span>
<a name="ln-287"></a>  <span class="c">!! @param[in] params Core KORC simulation parameters.</span>
<a name="ln-288"></a>  <span class="c">!! @param mpi_process_finalized Flag indicating whether an individual MPI process was finalized correctly.</span>
<a name="ln-289"></a>  <span class="c">!! @param mpierr MPI error status.</span>
<a name="ln-290"></a>  <span class="k">subroutine </span><span class="n">finalize_mpi</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-291"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">KORC_PARAMS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">params</span>
<a name="ln-292"></a>    <span class="kt">LOGICAL</span> 						<span class="kd">::</span> <span class="n">mpi_process_finalized</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-293"></a>    <span class="kt">INTEGER</span> 						<span class="kd">::</span> <span class="n">mpierr</span>
<a name="ln-294"></a>
<a name="ln-295"></a>    <span class="k">call </span><span class="n">MPI_BARRIER</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-296"></a>
<a name="ln-297"></a>    <span class="k">call </span><span class="n">MPI_FINALIZE</span><span class="p">(</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-298"></a>
<a name="ln-299"></a>    <span class="k">call </span><span class="n">MPI_FINALIZED</span><span class="p">(</span><span class="n">mpi_process_finalized</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-300"></a>
<a name="ln-301"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">mpi_process_finalized</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-302"></a><span class="k">       write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * COMMUNICATIONS * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-303"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot; ERROR: MPI not finalized well. MPI process: &quot;,I5)&#39;</span><span class="p">)</span> <span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span>
<a name="ln-304"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * * * ** * * * * * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-305"></a>    <span class="k">end if</span>
<a name="ln-306"></a><span class="k">  end subroutine </span><span class="n">finalize_mpi</span>
<a name="ln-307"></a>
<a name="ln-308"></a>
<a name="ln-309"></a>  <span class="c">! * * * * * * * * * * * *  * * * * * * * * * * * * * !</span>
<a name="ln-310"></a>  <span class="c">! ** SUBROUTINES FOR INITIALIZING COMMUNICATIONS  ** !</span>
<a name="ln-311"></a>  <span class="c">! * * * * * * * * * * * *  * * * * * * * * * * * * * !</span>
<a name="ln-312"></a>
<a name="ln-313"></a>  <span class="c">!! @note Subroutine for initializing MPI and open MP communications. @endnote</span>
<a name="ln-314"></a>  <span class="c">!! This subroutine initializes MPI and open MP communications and looks for</span>
<a name="ln-315"></a>  <span class="c">!! errors durignt this procces. The system environment</span>
<a name="ln-316"></a>  <span class="c">!! variables, which are modified by the user at the moment of</span>
<a name="ln-317"></a>  <span class="c">!! running/submitting a KORC simulation, are used to determine the</span>
<a name="ln-318"></a>  <span class="c">!! open MP configuration. Some open MP parameters are displayed on the</span>
<a name="ln-319"></a>  <span class="c">!! screen/output file.</span>
<a name="ln-320"></a>  <span class="c">!!</span>
<a name="ln-321"></a>  <span class="c">!! @param[in] params Core KORC simulation parameters.</span>
<a name="ln-322"></a>  <span class="c">!! @param mpi_process_finalized Flag indicating whether an individual MPI process was finalized correctly.</span>
<a name="ln-323"></a>  <span class="c">!! @param mpierr MPI error status.</span>
<a name="ln-324"></a>  <span class="k">subroutine </span><span class="n">initialize_communications</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-325"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">KORC_PARAMS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">params</span>
<a name="ln-326"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="n">MAX_STRING_LENGTH</span><span class="p">)</span> 		<span class="kd">::</span> <span class="n">string</span>
<a name="ln-327"></a>
<a name="ln-328"></a>    <span class="k">call </span><span class="n">initialize_mpi</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-329"></a>
<a name="ln-330"></a>    <span class="c">!$OMP PARALLEL SHARED(params)</span>
<a name="ln-331"></a>    <span class="n">params</span><span class="p">%</span><span class="n">num_omp_threads</span> <span class="o">=</span> <span class="n">OMP_GET_NUM_THREADS</span><span class="p">()</span>
<a name="ln-332"></a>    <span class="c">!$OMP END PARALLEL</span>
<a name="ln-333"></a>
<a name="ln-334"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-335"></a><span class="k">       write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * OMP SET-UP * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-336"></a>       <span class="c">!$OMP PARALLEL</span>
<a name="ln-337"></a>       <span class="c">!$OMP MASTER</span>
<a name="ln-338"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;OMP threads per MPI process: &quot;,I3)&#39;</span><span class="p">)</span> <span class="n">OMP_GET_NUM_THREADS</span><span class="p">()</span>
<a name="ln-339"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;Cores available per MPI process: &quot;,I3)&#39;</span><span class="p">)</span> <span class="n">OMP_GET_NUM_PROCS</span><span class="p">()</span>
<a name="ln-340"></a>       <span class="c">!$OMP END MASTER</span>
<a name="ln-341"></a>       <span class="c">!$OMP END PARALLEL</span>
<a name="ln-342"></a><span class="cp">#ifdef GNU</span>
<a name="ln-343"></a>       <span class="k">call </span><span class="nb">GET_ENVIRONMENT_VARIABLE</span><span class="p">(</span><span class="s2">&quot;OMP_PLACES&quot;</span><span class="p">,</span><span class="n">string</span><span class="p">)</span>
<a name="ln-344"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;OMP places: &quot;,A30)&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<a name="ln-345"></a>       <span class="k">call </span><span class="nb">GET_ENVIRONMENT_VARIABLE</span><span class="p">(</span><span class="s2">&quot;GOMP_CPU_AFFINITY&quot;</span><span class="p">,</span><span class="n">string</span><span class="p">)</span>
<a name="ln-346"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;OMP CPU affinity: &quot;,A30)&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<a name="ln-347"></a><span class="cp">#endif</span>
<a name="ln-348"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(&quot;* * * * * * * * * * * *  * * * * * * *&quot;,/)&#39;</span><span class="p">)</span>
<a name="ln-349"></a>    <span class="k">end if</span>
<a name="ln-350"></a><span class="k">  end subroutine </span><span class="n">initialize_communications</span>
<a name="ln-351"></a>
<a name="ln-352"></a><span class="k">end module </span><span class="n">korc_hpc</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> KORC was developed by Matt Beidler</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>